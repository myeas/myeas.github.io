---
title: 精品配件库存核算及异常数据的调整
date: 2022-04-08 00:00:00
permalink: /pages/special-104000/
categories:
  - 精品配件管理
tags:
  - 存货核算
private: true     # 开启文章私密，必须
#username: eashelp  # 用户名，必须
#password: 123456  # 密码，必须
#expire: 60000     # 登录状态超时清除时间，可选（不填则以全局超时时间为准，如果全局没有设置，则默认是一天）
#titleTag: 工具 # v1.0.0+ #标题标记
#navbar: false
#sidebar: false
#article: false
#comment: false
#editLink: false
#author:
# name: 作者
# link: https://xxx.com
sticky: 1  # 置顶，1 最高，数字越大，置顶地位越低下
---

# 精品配件库存核算及异常数据的调整

::: note 快速查找小技巧

- 您可以通过顶部搜索框，搜索需要的内容，并快速定位和链接到相应的内容；
- 您可以通过顶部导航、左侧导航（如有），快速定位到需要的章节；
- 您可以通过右侧导航（如有），快速定位到本章节的小节主题；
- 您可以通过 CTRL + F 搜索关键词，快速定位到本章节的具体内容处；
- 您如果发现本章节的错误、或有不明白的地方，可以通过[QQ群](https://jq.qq.com/?_wv=1027&k=Y6HPvi87)进行反馈。

:::

通过本章节的学习，了解库存单据有哪些，物料是如何按照库存类型流转业务的，又是如何分组的，物料的出库成本是如何核算的，再了解到系统中有哪些常用的库存报表，进而掌握如何核查显著异常的物料，并掌握调整异常数据的方法，确保业务规范、数据核算准确。

**本章节目录**：

[[TOC]]



## 一、库存单据

库存单据，按发生方向，区分为两大类：入库单据、出库单据。

本小节仅简要概述了库存单据，如想了解更多信息，请参考此链接：[库存单据种类](/pages/special-104011/#_3-1-库存单据种类)。

### 1.1 入库单据（或收入单据）

入库单据包含：

- **采购入库单**：

  适用场景：向供应商采购，有价值。

  部分门店有想当然的创造采购入库，比如以本门店、车间、账外等所谓的供应商为供应商，实现对盘盈的入库，随意指定成本。这是严重的错误。

  供应商赠送、盘盈等入库，请以其他入库单的进行登记。

- **其他入库单**：

  适用场景：供应商赠送、盘盈、工具、旧件等的入库。

  一般实际成本为0。其他入库单必须有审批手续，确认其合理合规合乎流程等。

  特别是盘盈，不得随意做，必须查明原因，确认是因为应交客户而无需交付（如更换机油）等原因才可以做。不能因为是其他该做的操作但没做而导致的盘盈（比如应采购入库而没做采购入库，再比如应销售退库而没做销售出库负数等）。

- **调拨入库单**：

  适用场景：门店内部不同仓库或库位之间的物料存放位置调整。

  必须同步有调拨出库（且同库存类型）。且必须由同一上游库存调拨单生成，库存调拨单的业务类型必须为`跨仓库调拨（成本价）`。

  库存调拨单，通过定制，已支持同仓库但不同库位的物料存放位置调整。

- 生产入库单：我们不用。

- **入库成本调整单**：（成本调整单，业务类型为入库，简称入库成本调整单）

  适用场景：禁止手工新增。由系统采购核销自动生成。

  成本调整单，业务类型为入库，简称入库成本调整单，不允许手工新增。

入库单据，生成凭证时，记账要素`1001 物料科目`绑定的科目（如 1405.02.02库存商品-配件、1405.02.03库存商品-精品），必须在借方。

不含退字样，为正数。成本调整单金额为正数，则为正数。

含退字样，为负数。成本调整单金额为负数，则为负数。

正数，增加库存/金额；

负数，减少库存/金额。

### 1.2 出库单据（或发出单据）

出库单据包含：

- **销售出库单**：

  适用场景：因精品配件销售交付客户（核心单据类型：精品配件销售单）、因维修交付客户（核心单据类型：维修工单）。

  日常一般不得有非规范的销售出库单（即：核心单据类型为销售出库单或销售订单），除非按本章节的指引调整历史的错误。

- **其他出库单**：

  适用场景：市场活动、漆辅料、盘亏、旧件出库等。其他出库必须有审批手续。

- **调拨出库单**：

  适用场景：门店内部不同仓库或库位之间的物料存放位置调整。

  必须同步有调拨入库（且同库存类型）。且必须由同一上游库存调拨单生成，库存调拨单的业务类型必须为`跨仓库调拨（成本价）`。

  库存调拨单，通过定制，已支持同仓库但不同库位的物料存放位置调整。

- **领料出库单**：

  适用场景：市场活动、漆辅料等的内部领用。

  功能和其他出库单类似，可不用此单据，都用其他出库单。同样必须有审批手续。

- **出库成本调整单**：（成本调整单，业务类型为出库，简称出库成本调整单）

  适用场景：因历史单据操作错误，出库成本核算错误，物料计价方法错误导致出库成本异常等，结合实际允许手工新增。

  ::: warning 提醒

  - 并不是所有的异常数据调整都通过出库成本调整单进行调整，否则可能越调整越错误。
  - 异常数据的调整，必须结合实际发生的原因，采取不同的方法，但核心原则不变：`原来如何错误的，则先以同样错误的方式并以相反金额冲掉原来的单据，再按正确的操作补调单据`。

  :::

出库单据，生成凭证时，记账要素`1001 物料科目`绑定的科目（如 1405.02.02库存商品-配件、1405.02.03库存商品-精品），必须在贷方。

不含退字样，为正数。成本调整单金额为正数，则为正数。

含退字样，为负数。成本调整单金额为负数，则为负数。

正数，减少库存/金额；

负数，增加库存/金额。

## 二、事务类型分组（重点，请务必区分）

金蝶EAS系统中，事务类型是库存业务中非常重要、非常重要的一个概念，其决定了物料流转过程中，是增加还是减少数量或金额、物料成本的核算逻辑、核销处理、对账处理等核心业务。我们不在此阐述其复杂的逻辑和原理，仅就业务流转过程中，日常操作人员应掌握的基本知识进行描述。

::: tip 重要的事情说三遍：

- 物料是按照事务类型分组影响数量、金额，并核算成本的。不同组别的数据混乱操作，将导致无法出库、核销出错、成本异常等问题。

- 物料是按照事务类型分组影响数量、金额，并核算成本的。不同组别的数据混乱操作，将导致无法出库、核销出错、成本异常等问题。

- 物料是按照事务类型分组影响数量、金额，并核算成本的。不同组别的数据混乱操作，将导致无法出库、核销出错、成本异常等问题。

:::

每种库存单据，都有事务类型（部分单据隐藏了）和库存类型（隐藏的单据可以看库存类型）。

事务类型根据库存类型可以划分为四组：

- 组别一**普通**：库存类型为普通 ，最常见的业务，**核算数量和成本**，即选用了这类事务类型的单据，其单据上的`实际成本`或`调整金额`**必须有值**；所有不含`库存类型为其它`、`库存类型为赠品`，`逐步禁用`字样的事务类型，其库存类型均为普通；

- 组别二**其它**：库存类型为其它，较常见的业务，**核算数量，不核算成本**，即选用了这类事务类型的单据，其单据上的`实际成本`或`调整金额`**不得有值**；

- 组别三**赠品**：库存类型为赠品，已禁止使用，作用实际上和`其它`一样，只不过因为其有赠品字样，所以不再使用；

- 组别四**逐步禁用**：事务类型名称中含有`逐步禁用`字样，库存类型为普通，已严禁使用，使用这些事务类型，将`导致成本出现错误`。<u>**如历史已使用过，且当前有库存数量，需要尽快调整。组别四禁止还有结存数量和结存金额。当前还有的，一律要调整。在调整前，先进行核查，再联系本部予以临时启用这些事务类型，并按本部指导要求调整库存数量和库存金额**</u>。

  逐步禁用，最容易导致成本核算错误，本章节会重点讲解，请尽快按照指引调整后，不得再使用。

::: danger 特别强调

- 库存数量和金额要发生入库或出库，**必须在同组内发生**，否则将导致数量、成本出错，或者提示库存不足；

- 普通组（组别一）的单据，必须有数量和实际成本（调整金额），否则是错误的；

  其它组（组别二）、赠品组（组别三）、逐步禁用组（组别四），必须有数量，且必须实际成本（调整金额）为0，否则是错误的；

- 普通组（组别一）和逐步禁用组（组别四），因为其事务类型都是`普通`，门店经常入库是组别一，出库却是组别四，导致出现异常数据。

- 库存数量的增加或减少，是以 **`物料`+`批次`+`计量单位`+`基本计量单位`+`辅助计量单位`+`仓库`+`库位`+`库存类型`+`库存状态`+`库存组织`** 的组合维度来增加或减少的，因此当组合维度不一致时，增加时会形成新的组合数据，减少时就可能导致无法出库，提示库存不足。库存金额，同理。
- **最常见的出错，大多是因为`忽略三组计量单位、库存类型`**，其他维度比较好理解（如物料、仓库、库位）或基本不用（批次）或所有均一致（如库存状态）不太会出错。
- 所有入库和出库必须在同组别内进行，否则将导致但不限于如下问题：
  - 无法出库（如入库为组别二，出库想出在组别一 等等）
  - 库存混乱（如出库为组别二但退回时却在组别一，或如入库在组别一但退回时却在组别二 等等）
  - 成本核算错误（如入库在组别四但出库在组别一，或如入库在组别一但出库在组别四 等等）

:::

::: warning 禁止虚做采购入库！！！

- 非真正采购业务的库存增加，禁止通过采购入库单虚做。

- 供应商赠送的或应当为0成本的，禁止通过采购入库流程完成入库，更不得虚指定所谓的0.01之类的单位成本。供应商赠送的，应当通过其他入库单，事务类型为`0921 零成本其他入库-赠送（库存类型为其它）`（即组别二），实际成本为0的方式进行入库。

- 盘盈的，必须经过部门负责人、财务、门店店总、甚至是本部的管理小组、本部的资产财务部等环节的审批，确保盘盈是真实、合理、合规、合乎流程的，才可以盘盈入库。盘盈的物料，通过其他入库单进行登记。

- 上述以组别二入库的物料，出库时且向客户交付的，以销售出库单出库为承载，事务类型为：`0940 零成本销售出库（库存类型为其它）`。

  上述以组别二入库的物料，出库时且由内部耗用的，以其它出库单出库为承载，事务类型为：`0951 零成本其他出库（库存类型为其它）`。

- 上述这种虚采购入库，虚指定成本，首先会导致日常成本核算出错（因为出库成本是按加权核算得出），其次会导致可能出到最后，因为没有成本了，做普通出库时，会提示成本为0无法审核出库。仓库人员又想尽一切办法出库，接着就错上加错，以`0947 普通销售出库（零成本）（逐步禁用请不要再选择）`的事务类型出库。

- <u>所有事务类型含`（逐步禁用请不要再选择）`字样的，不得再用于日常业务。只允许调整以前遗留的错误。调整完毕后，后续任何业务均不得再使用。</u>

- 如果不遵循上述要求，将导致无法出库、出库成本出错、业务和财务对账不平、几个库存报表之间（如库存类型收发汇总表及明细表、普通物料收发事务汇总表及明细、存货收发存汇总表及明细、库存账龄分析表等）不一致等一系列问题。

:::

### 2.1 组别一-普通组（库存类型为普通、参与成本核算、入库和出库必须有成本）

**显著特征：事务类型名称中  <u>不含有</u>  `库存类型为其它`、`库存类型为赠品`、`逐步禁用`字样**。

成本调整单，如分录的库存类型为`普通`，归为组别一。

:::: details 组别一普通组-事务类型名称中不含「库存类型为其它」、「库存类型为赠品」、「逐步禁用」字样，点击展开详细内容

所有入库和出库必须在同组别内进行，否则将导致但不限于如下问题：

- 无法出库（如入库为组别二，出库想出在组别一 等等）
- 库存混乱（如出库为组别二但退回时却在组别一，或如入库在组别一但退回时却在组别二 等等）
- 成本核算错误（如入库在组别四但出库在组别一，或如入库在组别一但出库在组别四 等等）

<table>
  <tr>
    <th>业务单据</th>
    <th>事务类型</th>
    <th>库存类型</th>
    <th>库存数量/金额<br>增加/减少</th>
  </tr>
  <tr>
    <th colspan="4">组别一：库存类型为普通的通用事务类型（同步增加数量/成本金额、同步减少数量/成本金额）</th>
  </tr>
  <tr>
    <td>日常普通：采购入库单</td>
    <td>正数入库：001 普通采购/委外入库</td>
    <td>普通</td> 
    <td>增加</td>
  </tr>
  <tr>
    <td>日常普通：采购入库单</td>
    <td>负数入库：002 普通采购/委外退库</td>
    <td>普通</td>  
    <td>减少，冲001</td>
  </tr>
  <tr>
    <td>日常普通：其他入库单</td>
    <td>正数入库：032 无来源手工入库</td>
    <td>普通</td> 
    <td>增加</td>
  </tr>
  <tr>
    <td>日常普通：其他入库单</td>
    <td>负数入库：0321 无来源手工退库</td>
    <td>普通</td>  
    <td>减少，冲032</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（精品销售）</td>
    <td>正数出库：2420 精品销售出库（进精品成本）</td>
    <td>普通</td> 
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（精品销售）</td>
    <td>负数出库：2421 精品销售退库（进精品成本）</td>
    <td>普通</td>  
    <td>增加，冲2420</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（配件销售）</td>
    <td>正数出库：2430 配件销售出库（进配件成本）</td>
    <td>普通</td> 
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（配件销售）</td>
    <td>负数出库：2431 配件销售退库（进配件成本）</td>
    <td>普通</td>  
    <td>增加，冲2430</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>正数出库：2510 维修出库（一般维修）</td>
    <td>普通</td> 
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>负数出库：2511 维修退库（一般维修）</td>
    <td>普通</td>  
    <td>增加，冲2510</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>正数出库：2520 维修出库（索赔）</td>
    <td>普通</td> 
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>负数出库：2521 维修退库（索赔）</td>
    <td>普通</td>  
    <td>增加，冲2520</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>正数出库：2530 维修出库（理赔）</td>
    <td>普通</td> 
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>负数出库：2531 维修退库（理赔）</td>
    <td>普通</td>  
    <td>增加，冲2530</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>正数出库：2540 维修出库（自费事故）</td>
    <td>普通</td> 
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>负数出库：2541 维修退库（自费事故）</td>
    <td>普通</td>  
    <td>增加，冲2540</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>正数出库：2590 维修出库（其它）</td>
    <td>普通</td> 
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：销售出库单（维修）</td>
    <td>负数出库：2591 维修退库（其它）</td>
    <td>普通</td>  
    <td>增加，冲2590</td>
  </tr>
  <tr>
    <td>日常普通：调拨出库单</td>
    <td>正数出库：027 普通调拨出库</td>
    <td>普通</td>  
    <td>减少，与028匹配<br>同步需要调拨入库</td>
  </tr>
  <tr>
    <td>日常普通：调拨入库单</td>
    <td>正数入库：028 普通调拨入库</td>
    <td>普通</td>  
    <td>增加，与027匹配<br>同步需要调拨出库</td>
  </tr>
  <tr>
    <td>日常普通：其他出库单</td>
    <td>正数出库：029 无来源手工出库</td>
    <td>普通</td> 
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：其他出库单</td>
    <td>负数出库：0291 无来源手工出库（退库）</td>
    <td>普通</td>  
    <td>增加，冲029</td>
  </tr>
  <tr>
    <td>日常普通：领料出库单</td>
    <td>正数出库：020 领发料出库-参与生产成本核算</td>
    <td>普通</td>  
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：领料出库单</td>
    <td>负数出库：022 领发料退库-参与生产成本核算</td>
    <td>普通</td>  
    <td>增加，冲020</td>
  </tr>
  <tr>
    <td>日常普通：领料出库单</td>
    <td>正数出库：021 领发料出库-不参与生产成本核算</td>
    <td>普通</td> 
    <td>减少</td>
  </tr>
  <tr>
    <td>日常普通：领料出库单</td>
    <td>负数出库：023 领发料退库-不参与生产成本核算</td>
    <td>普通</td>  
    <td>增加，冲021</td>
  </tr>
  <tr>
    <td>日常普通：成本调整单</td>
    <td>业务类型：入库（禁止手工直接新增，必须由系统自动生成）</td>
    <td>普通</td>  
    <td>正数增加金额<br>负数减少金额</td>
  </tr>
  <tr>
    <td>日常普通：成本调整单</td>
    <td>业务类型：出库</td>
    <td>普通</td>  
    <td>正数减少金额<br>负数增加金额</td>
  </tr>
</table>

::::

### 2.2 组别二-其它组（库存类型为其它、不参与成本核算、入库和出库必须0成本）

**显著特征：事务类型名称中含有`库存类型为其它`字样**。

成本调整单，如分录的库存类型为`其它`，归为组别二。

:::: details 组别二-事务类型名称中含有「库存类型为其它」字样，点击展开详细内容

所有入库和出库必须在同组别内进行，否则将导致但不限于如下问题：

- 无法出库（如入库为组别二，出库想出在组别一 等等）
- 库存混乱（如出库为组别二但退回时却在组别一，或如入库在组别一但退回时却在组别二 等等）
- 成本核算错误（如入库在组别四但出库在组别一，或如入库在组别一但出库在组别四 等等）



<table>
  <tr>
    <th>业务单据</th>
    <th>事务类型</th>
    <th>库存类型</th>
    <th>库存数量/金额<br>增加/减少</th>
  </tr>
  <tr>
      <th colspan="4">组别二：库存类型为其它（实际成本不允许有值，增加数量、减少数量）</th>
  </tr>
  <tr>
    <td>日常其它：其他入库单</td>
    <td>正数入库：0920 零成本其他入库-盘盈（库存类型为其它）</td>
    <td>其它</td> 
    <td>增加</td>
  </tr>
  <tr>
    <td>日常其它：其他入库单</td>
    <td>正数入库：0921 零成本其他入库-赠送（库存类型为其它）</td>
    <td>其它</td>  
    <td>增加</td>
  </tr>
  <tr>
    <td>日常其它：其他入库单</td>
    <td>负数入库：0922 零成本其他入退库（库存类型为其它）</td>
    <td>其它</td>  
    <td>减少，冲0920、0921</td>
  </tr>
  <tr>
    <td>日常其它：销售出库单</td>
    <td>正数出库：0940 零成本销售出库（库存类型为其它）</td>
    <td>其它</td>  
    <td>减少</td>
  </tr>
  <tr>
    <td>日常其它：销售出库单</td>
    <td>负数出库：0941 零成本销售退库（库存类型为其它）</td>
    <td>其它</td>  
    <td>增加，冲0920、0921</td>
  </tr>
  <tr>
    <td>日常其它：其他出库单</td>
    <td>正数出库：0951 零成本其他出库（库存类型为其它）</td>
    <td>其它</td>  
    <td>减少</td>
  </tr>
  <tr>
    <td>日常其它：其他出库单</td>
    <td>负数出库：0952 零成本其他出退库（库存类型为其它）</td>
    <td>其它</td>  
    <td>增加，冲0951</td>
  </tr>
  <tr>
    <td>日常其它：调拨出库单</td>
    <td>正数出库：4333-1 调拨出库（库存类型为其它）</td>
    <td>其它</td>  
    <td>减少，与4333-2匹配<br>必须同步有调拨入库</td>
  </tr>
  <tr>
    <td>日常其它：调拨入库单</td>
    <td>正数入库：4333-2 调拨入库（库存类型为其它）</td>
    <td>其它</td>  
    <td>增加，与4333-1匹配<br>必须同步有调拨出库</td>
  </tr>
  <tr>
    <th colspan="4">如下四项，为特殊其它，索赔旧件只能在这四项中入库、出库，不得与日常其它混用</th>
  </tr>
  <tr>
    <td>特殊其它：其他入库单（索赔旧件）</td>
    <td>正数入库：0971 其他入库（索赔旧件-库存类型为其它）</td>
    <td>其它</td>  
    <td>增加</td>
  </tr>
  <tr>
    <td>特殊其它：其他出库单（索赔旧件）</td>
    <td>正数出库：0973-1 其他出库（索赔旧件退运给厂家-库存类型为其它）</td>
    <td>其它</td>  
    <td>减少</td>
  </tr>
  <tr>
    <td>特殊其它：其他出库单（索赔旧件）</td>
    <td>正数出库：0973-2 其他出库（索赔旧件销毁-库存类型为其它）</td>
    <td>其它</td>  
    <td>减少</td>
  </tr>
  <tr>
    <td>特殊其它：其他出库单（索赔旧件）</td>
    <td>正数出库：0973-3 其他出库（索赔旧件一次性件-库存类型为其它）</td>
    <td>其它</td>  
    <td>减少</td>
  </tr>
  <tr>
    <th colspan="4">如下两项，为特殊其它，理赔旧件只能在这两项中入库、出库，不得与日常其它混用</th>
  </tr>
  <tr>
    <td>特殊其它：其他入库单（理赔旧件）</td>
    <td>正数入库：0972 其他入库（保险旧件-库存类型为其它）</td>
    <td>其它</td>  
    <td>增加</td>
  </tr>
  <tr>
    <td>特殊其它：其他出库单（理赔旧件）</td>
    <td>正数出库：0974 其他出库（保险旧件-库存类型为其它）</td>
    <td>其它</td>  
    <td>减少</td>
  </tr>
</table>

::::

### 2.3 组别三-赠品组（库存类型为赠品、不参与成本核算、入库和出库必须0成本）

**显著特征：事务类型名称中含有`库存类型为赠品`字样**。

成本调整单，如分录的库存类型为`赠品`，归为组别三。

功能与组别二一致，被组别二替代，不再使用。仅再适用于调整历史错误，或即有库存出库。

:::: details 组别三-事务类型名称中含有「库存类型为赠品」字样，点击展开详细内容

所有入库和出库必须在同组别内进行，否则将导致但不限于如下问题：

- 无法出库（如入库为组别二，出库想出在组别一 等等）
- 库存混乱（如出库为组别二但退回时却在组别一，或如入库在组别一但退回时却在组别二 等等）
- 成本核算错误（如入库在组别四但出库在组别一，或如入库在组别一但出库在组别四 等等）



<table>
  <tr>
    <th>业务单据</th>
    <th>事务类型</th>
    <th>库存类型</th>
    <th>库存数量/金额<br>增加/减少</th>
  </tr>
  <tr>
    <th colspan="4">组别三：库存类型为赠品（实际成本不允许有值，增加数量、减少数量），已禁止使用，被库存类型为其它替代</th>
  </tr>
  <tr>
    <td>禁用赠品：采购入库单</td>
    <td>正数入库：0913 赠品入库（库存类型为赠品）</td>
    <td>赠品</td>  
    <td>增加</td>
  </tr>
  <tr>
    <td>禁用赠品：采购入库单</td>
    <td>负数入库：0914 赠品入退库（库存类型为赠品）</td>
    <td>赠品</td>  
    <td>减少，冲0913</td>
  </tr>
  <tr>
    <td>禁用赠品：其他入库单</td>
    <td>正数入库：0923 赠品其他入库（库存类型为赠品）</td>
    <td>赠品</td>  
    <td>增加</td>
  </tr>
  <tr>
    <td>禁用赠品：其他入库单</td>
    <td>负数入库：0924 赠品其他入退库（库存类型为赠品）</td>
    <td>赠品</td>  
    <td>减少，冲0923</td>
  </tr>
  <tr>
    <td>禁用赠品：销售出库单</td>
    <td>正数出库：0943 赠品出库（库存类型为赠品）</td>
    <td>赠品</td>  
    <td>减少</td>
  </tr>
  <tr>
    <td>禁用赠品：销售出库单</td>
    <td>负数出库：0944 赠品退库（库存类型为赠品）</td>
    <td>赠品</td>  
    <td>增加，冲0943</td>
  </tr>
  <tr>
    <td>禁用赠品：其他出库单</td>
    <td>正数出库：0953 赠品其他出库（库存类型为赠品）</td>
    <td>赠品</td>  
    <td>减少</td>
  </tr>
  <tr>
    <td>禁用赠品：其他出库单</td>
    <td>负数出库：0954 赠品其他出退库（库存类型为赠品）</td>
    <td>赠品</td>  
    <td>增加，冲0953</td>
  </tr>
</table>

::::

### 2.4 组别四-逐步禁用组（库存类型为普通、不参与成本核算、入库和出库必须0成本）

**显著特征：事务类型名称中含有`逐步禁用`字样**。

成本调整单，如分录的库存类型为`普通`，归为组别一，不归组别四。

功能与组别二一致，被组别二替代，不再使用。仅再适用于调整历史错误，或即有库存出库。

由于组别一和组别四，其事务类型均为普通，很容易造成错误、出现混乱操作，因此严禁使用。仅再适用于调整历史错误，如当前仍有组别四的库存，需要尽快处理，调整完后不得再发生任何数据。

:::: details 组别四-事务类型名称中含有「逐步禁用」字样，点击展开详细内容

所有入库和出库必须在同组别内进行，否则将导致但不限于如下问题：

- 无法出库（如入库为组别二，出库想出在组别一 等等）
- 库存混乱（如出库为组别二但退回时却在组别一，或如入库在组别一但退回时却在组别二 等等）
- 成本核算错误（如入库在组别四但出库在组别一，或如入库在组别一但出库在组别四 等等）

<table>
  <tr>
    <th>业务单据</th>
    <th>事务类型</th>
    <th>库存类型</th>
    <th>库存数量/金额<br>增加/减少</th>
  </tr>
  <tr>
    <th colspan="4">组别四：逐步禁用（实际成本不允许有值，增加数量、减少数量），已禁止使用，会与组别一混淆，导致成本核算错误</th>
  </tr>
  <tr>
    <td>易混淆：其他入库单</td>
    <td>正数入库：0927 其他入库零成本（逐步禁用请不要再选择）</td>
    <td>普通</td>  
    <td>增加</td>
  </tr>
  <tr>
    <td>易混淆：其他入库单</td>
    <td>负数入库：0928 其他入退库零成本（逐步禁用请不要再选择）</td>
    <td>普通</td>  
    <td>减少，冲0927</td>
  </tr>
  <tr>
    <td>易混淆：销售出库单</td>
    <td>正数出库：0947 普通销售出库零成本（逐步禁用请不要再选择）</td>
    <td>普通</td>  
    <td>减少</td>
  </tr>
  <tr>
    <td>易混淆：销售出库单</td>
    <td>负数出库：0948 普通销售退库零成本（逐步禁用请不要再选择）</td>
    <td>普通</td>  
    <td>增加，冲0947</td>
  </tr>
</table>

::::

## 三、成本核算的基本算法

实际上成本核算，仅指的是出库单据的成本核算，不包含入库单据。入库单据均由手工指定（除成本价调拨入库由调拨出库带出、核销自动生成的入库成本调整单之外）。

基于业务场景和管理特点，国机汽车体系各零售门店，在金蝶EAS系统中，精品配件等物料的核算依据为：

- 计价方法：实时移动加权平均法
- 核算范围：按财务组织核算
- 暂估冲回方式：差额调整
- 库存单据按事务类型及是否参与核算，划分为四组（组别一普通组、组别二其它组、组别三赠品组、组别四逐步禁用组）

### 3.1 入库单据的成本来源

入库单据的成本一般是手工指定的，如：

- 采购入库是通过采购订单手工输入，根据含税单价、税率，计算得出。

- 其他入库单，手工指定。一般不允许指定为有值，应当均为0。

- 调拨入库单，是根据调拨出库同步过来的。

- 入库成本调整单，由采购入库单和应付单，通过核销功能，自动计算出来的。不允许手工新增入库成本调整单。

### 3.2 出库单据的成本来源

出库单据的成本，是由系统自动核算出来的，一般依据：

#### 3.2.1 单据的事务类型，事务类型定义是否参与核算

组别一（即普通的），定义为参与核算，每笔出库单据必须有成本。

组别二（库存类型为其它），定义为不参与核算，所以要求成本为0。

组别三（库存类型为赠品），定义为不参与核算，所以要求成本为0。被组别二替代。

组别四（逐步禁用不再使用），定义为不参与核算，所以要求成本为0。但因为容易和组别一混淆，导致成本核算出错。严禁新发生，历史数据尽快处理。

上述特征务必牢记。

#### 3.2.2 暂估冲回方式

这里实际上是采购环节的暂估的冲回处理。

- **差额调整**：采购入库单与应付单核销，如有差异，以差异生成入库成本调整单。

  **国机汽车各零售门店，全部采用`差额调整`暂估冲回方式**。

- 月初一次冲回：不管发票是否收到，月初自动冲回暂估凭证。复杂、容易乱。入库本月未到票的先暂估，月末结账时系统针对已暂估的凭证，自动生成冲回凭证，下月结账前依然未到票的继续暂估，结账时继续冲回，直到到票核销后，通过核销记录直接生成正式凭证。

- 单到冲回：入库当月未到票的先暂估，票到后与入库核销，在核销记录处生成冲回凭证与正式凭证。

#### 3.2.3 核算范围

- **分财务组织**：核算维度：`财务组织`。即同一公司范围内核算出库成本，不区分库存组织、仓库，即物料存放于不同的库存组织、仓库，不会影响成本的核算。

  **国机汽车各零售门店，全部为`分财务组织`核算**。

- 分库存组织：核算维度：`财务组织`+`库存组织`。同一公司可能设置若干库存组织，同一库存组织范围内核算出库成本，同一物料不同库存组织，成本可能不一样。

- 分仓库：核算维度：`财务组织`+`库存组织`+`仓库`。按仓库核算成本，需要严格的标准的仓库管理，同一公司/同一库存组织，会设置若干仓库，同一仓库范围内核算出库成本，同一物料不同仓库，成本可能不一样。

#### 3.2.4 物料的计价方法

这是物料核算成本的重要基础。常用计价方法：

- **实时移动加权平均法**：单据审核时核算出库成本。也可通过`材料出库核算`功能重新核算。每一笔业务视为一个期间。如果本笔出库单据与上笔出库单据中间有入库单据，则本笔会受入库单据的成本影响。

  **国机汽车各零售门店，一般采用`实时移动加权平均法`**。

- 移动加权平均法：单据审核时，不核算出库成本。通过`材料出库核算`功能核算。每一笔业务视为一个期间。如果本笔出库单据与上笔出库单据中间有入库单据，则本笔会受入库单据的成本影响。

- 加权平均法：单据审核时，不核算出库成本。通过`材料出库核算`功能核算。一般来说，每月成本一致。

- 个别计价法：一般要同时启用批次管理。同批次，加权平均核算。

#### 3.2.5 不同计价方法核算成本简要公式

- **实时移动加权平均法**：（每一笔视为一个期间）

  `存货单位实际成本`=（`上一笔业务后的结存金额`）/（`上一笔业务后的结存数量`）

  审核时触发计算，也可通过`材料出库核算`计算。

  **当审核时核算出来的成本为0或负数，则审核时会报核算中止错误**。

  该单据生成凭证后，核算出来的成本不会更新单据，即要通过材料出库核算更新出库单的成本，必须在单据生成凭证前。

  通过核算，我们可以发现：

  - 当本笔出库与上笔出库，中间没有入库单据/出库单据负数时，则本笔与上笔核算的单位成本应该一致；（尾差、四舍五入视为一致）。
  - 当本笔出库与上笔出库，中间有入库单据/出库单据负数时，但入库单据/出库单据负数与上笔出库单位成本一致，则本笔与上笔核算的单位成本应该一致；（尾差、四舍五入视为一致）。
  - 当本笔出库与上笔出库，中间有入库单据/出库单据负数时，但入库单据/出库单据负数与上笔出库单位成本不一致时，则本笔与上笔核算的单位成本会不一致。

- 移动加权平均法：（每一笔视为一个期间）

  存货单位实际成本=（上一笔业务后的结存金额）/（上一笔业务后的结存数量）

  审核时不触发计算，只能通过`材料出库核算`计算。

  如果不做材料出库核算，则出库单据上的成本为0。

  该单据生成凭证后，核算出来的成本不会更新单据，即要通过材料出库核算更新出库单的成本，必须在单据生成凭证前。

- 加权平均法：（每一会计期间为一个期间）

  存货单位实际成本=（上月末结存金额+本期入库金额）/（上月末结存数量+本期入库数量）

  如果不做材料出库核算，则出库单据上的成本为0。

  该单据生成凭证后，核算出来的成本不会更新单据，即要通过材料出库核算更新出库单的成本，必须在单据生成凭证前。

- 个别计价法：（每一会计期间为一个期间、且同批次）

  存货单位实际成本=（上月末结存金额同批次+本期入库金额同批次）/（上月末结存数量同批次+本期入库数量同批次）
  
  如果不做材料出库核算，则出库单据上的成本为0。
  
  该单据生成凭证后，核算出来的成本不会更新单据，即要通过材料出库核算更新出库单的成本，必须在单据生成凭证前。

实际上这几种计算方法底层逻辑是一样的，只不过附加了不同的维度，即期间范围、批次范围。

实际上系统还有更多更复杂的逻辑，这里就不展开描述。

### 3.3 材料出库核算

一般来说，要求物料的计量方法为`实时移动加权平均法`，出库单据审核时即计算出库成本，也可以在生成凭证前通过`材料出库核算`重新核算成本。

**`非实时移动加权平均法的物料，在其出库后，生成凭证前，必须做材料出库核算，否则出库单据上的成本为0`**。

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-30.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-30.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

**材料出库核算的参考步骤**：

**路径**：`〖财务会计〗-〖存货核算〗-〖出库核算〗-〖材料出库核算〗`

**前提**：单据已审核，但未生成凭证。如果已生成凭证，则材料出库核算后，不会更新已生成凭证的实际成本。

**作用**：更新销售出库单、其他出库单、调拨出库单（并同步更新调拨入库单）、领料出库单等出库单据的单位实际成本、实际成本。注意，不更新出库成本调整单的调整金额。

**步骤**：

- **第一步：选择存货编码范围**

  全部为空，则是本财务组织（库存组织）的所有物料；

  存货编码从为空但存货编码至不空，则核算的物料范围为存货编码小于等于存货编码至的物料；

  存货编码从不为空但存货编码至为空，则核算的物料范围为存货编码大于等于存货编码从的物料；

  存货编码从不为空且存货编码至不空，则核算的物料范围为存货编码大于等于存货编码从的、且小于等于存货编码至的物料。

  存货编码从的编码与存货编码至的编码一致，则只核算这单一物料。

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-31.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-31.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **第二步：核算单据检查**

  `检查核算范围内未审核单据`：检查所选的财务组织、库存组织、仓库、物料范围内参与核算并且未审核的库存单据（包括采购入库、其他入库、生产入库、调拨入库、销售出库、其他出库、领料出库、调拨出库、委外入库、委外发料、成本调整、标准价变更）；默认勾选，如果不取消勾选则出库核算时不做上述检查

  一般日常不勾选，避免因单据未审核导致核算失败。但期末一般都要勾选，以检查到还有未审核的单据。

  `核算范围内单价为0，已经审核入库类单据`：检查所选择的财务组织、库存组织、仓库、物料范围内参与核算并且已审核但分录单价为0的库存单据（包括采购入库、其他入库、生产入库、调拨入库），不包括入库赠品勾选行；默认勾选，如果取消勾选则出库核算不检查入库此类入库成本，可能导致计算出的成本异常，因此建议勾选。

  `异常单据查询`：一般无需操作。

  `异常数据调零`：请勿操作。

  `写成本计算报告`：默认勾选，勾选时，成本计算结束后会形成成本计算报告，不勾选则不写成本计算报告。建议勾选。

  `只写结转有误的物料`：默认勾选，勾选时，只记录成本计算过程中出现错误的行，正确的行不记录，不勾选时，记录全部的计算报告。请结合实际选择。

  期末全局所有存货核算时，一般全部勾选。

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-32.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-32.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **第三步：选择核算哪种计价方法的物料**

  选定范围的存货，存在几种计价方法，就得重复操作几次第一步、第二步、第三步等。

  同时，每次的第三步，就分别选择不同的计价方法。比如第一次选择实时移动平均法，第二次选择加权平均法，以此类推。

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-33.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-33.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

::: danger 特别强调

- 存货核算完成后，会在右下角弹出提示消息，也可在【消息中心】，通知-工作流，看到具体的核算成功还是失败的记录。
- 核算时间，视单据的多少、选择物料的范围多少，核算时间长度不一，一般都较快。
- **在未得到提示消息前，请务必不要反复操作材料出库核算**，否则将导致出库核算混乱。
- 同时，同一财务组织，不要同时操作材料出库核算功能。
- 核算完成后，可以通过【存货结转明细报告】，查看核算结果。

:::

## 四、常用的库存报表

系统为我们提供了众多的库存报表，现就几个常用的库存报表，做些简单的介绍，这些报表也是我们日常最频繁用到的，是我们统计库存明细、数量、金额的重要来源，也是我们发现异常数据、修正异常数据的依赖。各报表，可依据查询条件的组合，得到不同的结果，在此，我们无法穷举各种组合，需要各用户自行理解掌握，我们仅起抛砖引玉之作用。

### 4.1 库存类型收发汇总表及明细表

#### 4.1.1 库存类型收发汇总表

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存报表〗-〖库存类型收发汇总表〗`

**主要功能**：

**统计`若干库存组织`（一般每次查一个），在`指定日期`范围内的库存业务（`所有库存类型`）汇总数据**。包括：

- 期初库存：查询开始日期，0时的结存数量和金额。

  注意，这里的期初，不是指每个月的第一天。

- 期末库存：查询结束日期，24时的结存数量和金额。

  注意，这里的期末，不是指每个月的最后一天。

- 收入：查询日期范围内的所有入库单据的数据汇总。

- 发出：查询日期范围内的所有出库单据的数据汇总。

::: warning 提醒

- 如果不勾选显示库位，本报表收入和发出数据不包含通过库位移动单调整库存的数据。勾选显示库位，则包含库位移动单的数据。
- 可以按日期范围查询。
- **双击具体行，可联查同条件的库存类型收发明细表**。

:::

**查询示意图**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-11.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-11.png',
          
        ]
      }
    }
  }
</script>
```

:::

**主要条件**：

报表会因查询条件输入或选择的不同，显示出不同的效果。

注意，所有条件是`且`的关系，即查询所得数据同时满足设置的条件。

- 库存组织：指哪个门店；

- 日期从：指收入和发出数据从哪日开始统计；同时，也是确认期初库存的统计时点；

- 日期至：指收入和发出数据至哪日结束统计；同时，也是确认期末库存的统计时点；

- 物料编码从：按物料编码排序，从该物料编码开始查询；无法跳跃查询和多选；

- 物料编码至：按物料编码排序，到该物料编码结束查询；无法跳跃查询和多选；

- 其他各种从和至，请参考字面意思；

- 显示仓库：如果只勾选，报表数据会按仓库进行汇总；

- 显示库位：勾选这个，会自动同步勾选显示仓库，报表数据会按仓库及库位进行汇总；

- 显示合计行：显示合计行；

- **库存类型汇总**：按库存类型进行汇总，一般要求勾选；在本章节调整单据异常或成本异常，就和这个紧密关联；

- **单据状态**：区分为空/提交/审核；空，则显示所有状态的单据数据；提交，则显示提交状态的单据数据；审核，则只显示审核状态的单据数据；

  一般这里选择：审核。因为只有单据状态为审核，才会真正影响库存。

- 显示条件：一般我们在应用到本章节的内容时不选择，但在日常管理过程中，可结合实际业务选择。

  - 收入为0不显示：即入库单据没有发生，则不显示其所有的期初、收入、发出、结存数据；

  - 发出为0不显示：即出库单据没有发生，则不显示其所有的期初、收入、发出、结存数据；

  - **<u>收入和发出都为0不显示</u>**：即入库单据和发出单据都没有发生，则不显示其所有的期初、收入、发出、结存数据；

    通过选择此项，结合前面的日期范围（如均为当日，最近几日），显示库位，则可以以此数据进行库存动态盘点，统计在这几日有过入库或出库的物料及结存数量，与实际库存进行盘点。

  - 期初为0不显示：即查询开始日的期初没有结存，则不显示其所有的期初、收入、发出、结存数据；

  - 结存为0不显示：即查询截至日的期末没有结存，则不显示其所有的期初、收入、发出、结存数据；

  - 只显示结存为0：与结存为0不显示正好相反；

  - **<u>只显示结存数量为0金额不为0</u>**：仅统计结存数量为0但结存金额不为0的所有数据。

    这个显示条件，很重要，也是快速查询与库存账龄分析表有差异的方式之一。

    ::: note 库存账龄分析表

    库存账龄分析表，是基于库存数量进行统计分析的，负数量及0数量的数据并不会参与库龄账龄分析表的计算。而负数量，我们通过物料的库存资料已设置禁止负库存（个别没设置到的或因系统问题导致仍允许负数量，且库管人员在库存实际管理过程中又没有做到账实相符的，请另联系本部指导）。而结存数量为0但结存金额不为0，这个常常因为操作及核算的原因，无法完全杜绝。通过本显示条件，则可以快速查询到此异常数据。此异常数据如何处理，需要结合导致此数据异常的原因进行处理。

    :::

- 精度设置：

  数量显示精度：一般设置为3；

  辅助数量显示精度：一般设置为3；

  单位显示精度：一般设置为4-6；

  金额显示精度：一般设置为2。

::: danger 异常数据方面--直观核查库存类型为其它、库存类型为赠品的显著异常数据

- 通过查看库存类型为其它、库存类型为赠品的数据，查看`金额`列是否有值，如有值，则异常。
- 核查异常数据时，建议在库管员暂时不操作库存单据时查询并异出，避免因业务还在进行中，查询的数据总是在变化中，干扰了数据核对，造成不必要效率降低。
- 通过把日期从，设置为当日的下一次，日期至设置为较长远的日期，显示条件中选择`收入和发出都为0不显示`，则可以查询到`日期还没到但有业务发生`的物料，这显然不正常（提前结账，要求改到下月1日，类似这样的场景为例外）。

:::

#### 4.1.2 库存类型收发明细表

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存报表〗-〖库存类型收发明细表〗`

**主要功能**：

**统计指定单一`库存组织`，在`指定日期`范围内的库存业务（`所有库存类型`）发生数据**。

功能与库存类型收发汇总表一致，只不过是把发生明细逐行显示，以了解和掌握指定数据的全过程。

建议：明细表一般一次只查询一个物料，查多了物料，反而容易混乱。

**可通过库存类型收发汇总表，联查同条件的库存类型收发明细表，通过库存类型收发明细表，可联查具体的业务单据。**

`库存类型收发明细表，是我们核查成本核算、数据异常等，最频繁使用的报表，请务必掌握`。

**查询示意图**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-12.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-12.png',
          
        ]
      }
    }
  }
</script>
```

:::

**主要条件**：

查询条件，可结合字面意思，及参考前述库存类型收发汇总表的描述，本处不再展开描述。

**报表结果**：

当我们得到结果后，请结合报表中的库存类型、事务类型、收入、发出，检查数据的异常。

请按照事务类型，进行分组筛选，以帮助判断是哪些发生有异常。

事务类型根据库存类型可以划分为四组：

- **普通**：`库存类型为普通` ，最常见的业务，**核算数量和成本**，即选用了这类事务类型的单据，其单据上的`实际成本`或`调整金额`**必须有值**；

  所有不含`库存类型为其它`、`库存类型为赠品`，`逐步禁用`字样的事务类型，其库存类型均为普通；

- **其它**，`库存类型为其它`，较常见的业务，**核算数量，不核算成本**，即选用了这类事务类型的单据，其单据上的`实际成本`或`调整金额`**不得有值**；

- **赠品**，`库存类型为赠品`，已禁止使用，作用实际上和`其它`一样，只不过因为其有赠品字样，所以不再使用；

- **逐步禁用**，`事务类型名称含逐步禁用`字样，库存类型为普通，已严禁使用，使用这些事务类型，将`导致成本出现错误`。<u>**如历史已使用过，且当前有库存数量，需要尽快调整。在调整前，先进行核查，再联系本部予以临时启用这些事务类型，并按本部指导要求调整库存数量和库存金额**</u>。

::: danger 特别提醒

- 在本章节核查异常单据时，最频繁用到的就是本报表，是我们判断数据异常的重要参考。
- 一般为更准确查询数据，日期范围应当小于等于库存管理模块的启用期间的第一日；物料编码单一选择有异常数据的物料；单据状态选择`审核`；勾选`显示期初与结存`。
- 如果日期从，是选择为小于等于启用期间的第一日，则期初结存为库存类型为普通的数据（即组别一，初始化时无组别二、组别三、组别四的数据）。但如果不是小于等于启用期间，则期初结存不一定是库存类型为普通的数据，请注意！！！

:::

### 4.2 普通物料收发事务汇总表及明细表

#### 4.2.1 普通物料收发事务汇总表

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存报表〗-〖普通物料收发事务汇总表〗`

**主要功能**：

**统计`若干库存组织`（一般每次查一个），在`指定日期`范围内的库存业务（`仅包含库存类型为普通，即组别一、组别四`）汇总数据**。包括：

- 期初库存：查询开始日期，0时的结存数量和金额。

  注意，这里的期初，不是指每个月的第一天。

- 期末库存：查询结束日期，24时的结存数量和金额。

  注意，这里的期末，不是指每个月的最后一天。

- 收入：查询日期范围内的所有入库单据的数据汇总。

- 发出：查询日期范围内的所有出库单据的数据汇总。

::: warning 提醒

- 仅能查询库存类型为普通的数据，即组别一、组别四的，不能查询库存类型为其它、库存类型为赠品的数据。
- 可以按日期范围查询。
- **双击具体行，可联查同条件的普通物料收发明细表**。

:::

**查询示意图**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-15.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-15.png',
          
        ]
      }
    }
  }
</script>
```

:::

**主要条件**：

报表会因查询条件输入或选择的不同，显示出不同的效果。

注意，所有条件是`且`的关系，即查询所得数据同时满足设置的条件。

- 库存组织：指哪个门店；

- 日期从：指收入和发出数据从哪日开始统计；同时，也是确认期初库存的统计时点；

- 日期至：指收入和发出数据至哪日结束统计；同时，也是确认期末库存的统计时点；

- 物料编码从：按物料编码排序，从该物料编码开始查询；无法跳跃查询和多选；

- 物料编码至：按物料编码排序，到该物料编码结束查询；无法跳跃查询和多选；

- 其他各种从和至，请参考字面意思；

- 显示仓库：如果只勾选，报表数据会按仓库进行汇总；

- 显示库位：勾选这个，会自动同步勾选显示仓库，报表数据会按仓库及库位进行汇总；

- 显示合计行：显示合计行；

- **期初包含不参与核算的库存**：勾选则期初包含不参与核算的库存（即期初有组别一、组别四的数据），不勾选则期初不包含不参与核算的库存（即期初只有组别一的数据）；

- **单据状态**：区分为空/提交/审核；空，则显示所有状态的单据数据；提交，则显示提交状态的单据数据；审核，则只显示审核状态的单据数据；

  一般这里选择：审核。因为只有单据状态为审核，才会真正影响库存。

- 显示条件：一般我们在应用到本章节的内容时不选择，但在日常管理过程中，可结合实际业务选择。

  - 收入为0不显示：即入库单据没有发生，则不显示其所有的期初、收入、发出、结存数据；

  - 发出为0不显示：即出库单据没有发生，则不显示其所有的期初、收入、发出、结存数据；

  - **<u>收入和发出都为0不显示</u>**：即入库单据和发出单据都没有发生，则不显示其所有的期初、收入、发出、结存数据；

    通过选择此项，结合前面的日期范围（如均为当日，最近几日），显示库位，则可以以此数据进行库存动态盘点，统计在这几日有过入库或出库的物料及结存数量，与实际库存进行盘点。

  - 期初为0不显示：即查询开始日的期初没有结存，则不显示其所有的期初、收入、发出、结存数据；

  - 结存为0不显示：即查询截至日的期末没有结存，则不显示其所有的期初、收入、发出、结存数据；

  - 只显示结存为0：与结存为0不显示正好相反；

  - **<u>只显示结存数量为0金额不为0</u>**：仅统计结存数量为0但结存金额不为0的所有数据。

- 精度设置：

  数量显示精度：一般设置为3；

  辅助数量显示精度：一般设置为3；

  单位显示精度：一般设置为4-6；

  金额显示精度：一般设置为2。

::: danger 异常数据方面--对比核查组别四异常数据

- 通过普通物料收发事务汇总表，其他条件保持一致，勾选与不勾选`期初包含不参与核算的库存`，分别导出数据至EXCEL，再在EXCEL中，对期初数据进行VLOOKUP，查询两组EXCEL的差异，期初数量、金额不相等的物料，则为异常数据。
- 注意，这里无法直接查询指定日期范围内的发生数据中是否有不参与核算的数据。但可以变通处理，把日期从设置为当日的下一日，比如当前是4月10日，我们查询4月1日至4月10日的数据，这里通过勾选与不勾选`期初包含不参与核算的库存`，可以对比出来4月1日期初的异常数据，但无法查询4月1日至4月10日发生的异常数据。则我们可以把日期至的日期放到日期从的日期，即查询4月11日至4月11日的数据，再导出对比4月11日的期初，则可以得到异常数据。在实际操作过程中，我们也是调整结存，所以发生数据有没有异常，关系不大。
- 核查异常数据时，建议在库管员暂时不操作库存单据时查询并异出，避免因业务还在进行中，查询的数据总是在变化中，干扰了数据核对，造成不必要效率降低。

:::

#### 4.2.2 普通物料收发事务明细表

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存报表〗-〖普通物料收发事务明细表〗`

**主要功能**：

**统计指定`单一库存组织`，在`指定日期`范围内的库存业务（`仅库存类型为普通，即组别一、组别四`）发生数据**。

功能与普通物料收发事务汇总表一致，只不过会把发生明细逐行显示，以了解和掌握指定数据的全过程。

明细表一般一次只查询一个物料，查多了物料，反而容易混乱。

**可通过普通物料收发事务汇总表，联查同条件的普通物料收发事务明细表，通过普通物料收发事务明细表，可联查具体的业务单据。**

::: danger 特别提醒

- 一般不建议使用该报表，建议使用库存类型收发明细表。因为后者涵盖了前者的内容。
- 普通物料收发事务明细表，仅是显示库存类型为普通的数据。
- 库存类型收发明细表，不只可以显示库存类型为普通的数据，还可以显示库存类型为其它、库存类型为赠品的数据，因此更全。
- 如果遇到异常数据，仅看普通物料收发事务明细表，可能会干扰判断，做出不正确的调整或不能发现错误。

:::

**查询示意图**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-16.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-16.png',
          
        ]
      }
    }
  }
</script>
```

:::

**主要条件**：

查询条件，可结合字面意思，及参考前述普通物料收发事务汇总表的描述，本处不再展开描述。

**报表结果**：

当我们得到结果后，请结合报表中的事务类型、收入、发出，检查数据的异常。

比如组别四逐步禁用组的数据，如果在收入列、发出列金额字段有值，则显著不正确。

比如组别一普通组的数据，如果在收入列、发出列金额字段没有值，则要考虑该物料计价方法是不是有错。

本报表中，事务类型名称含`逐步禁用`字样的为组别四，其他的为组别一的数据。

一般建议核查异常数据时，日期从，请选择库存系统启用期间的第1日，日期至为当日。

### 4.3 存货收发存汇总表及明细表

#### 4.3.1 存货收发存汇总表

**报表路径**：`〖财务会计〗-〖存货核算〗-〖报表分析〗-〖存货收发存汇总表〗`

**主要功能**：

**统计`单一财务组织`，在`指定期间`范围内的库存业务（`仅包含库存类型为普通，即组别一、组别四`）汇总数据**。包括：

- 期初库存：查询开始期间，第1日0时的结存数量和金额。

- 期末库存：查询结束期间，最后1日24时的结存数量和金额。

- 收入：查询期间范围内的所有库存类型为普通的入库单据的数据汇总。实际上还有另外两种：委托代销、借出，但我们未用到，所以视同只能查询库存类型为普通的。
- 发出：查询期间范围内的所有库存类型为普通的出库单据的数据汇总。实际上还有另外两种：委托代销、借出，但我们未用到，所以视同只能查询库存类型为普通的。

::: warning 提醒

- 仅能查询库存类型为普通的数据，即组别一、组别四的，不能查询库存类型为其它、库存类型为赠品的数据。
- 按期间范围查询，无法按日期范围查询。
- **双击具体行，可联查同条件的存货收发存明细表**。

:::

**查询示意图**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-21.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-21.png',
          
        ]
      }
    }
  }
</script>
```

:::

**主要条件**：

报表会因查询条件输入或选择的不同，显示出不同的效果。

注意，所有条件是`且`的关系，即查询所得数据同时满足设置的条件。

- 财务组织：指哪个门店。

- 会计期间从：指收入和发出数据从哪个期间开始统计；同时，也是确认期初库存的统计时点。

- 会计期间至：指收入和发出数据至哪个期间结束统计；同时，也是确认期末库存的统计时点。

- 存货编码从：按物料编码排序，从该存货编码开始查询；无法跳跃查询和多选。

- 存货编码至：按物料编码排序，到该存货编码结束查询；无法跳跃查询和多选。

- 库存类型：实际上系统支持查询三种：普通、委托代销、借出。但不支持查询其它、赠品。同时，我们实际上未用到委托代销、借出。所以本报表我们视同只能查询普通。

- 记账分类：可筛选条件为各门店设定的记账分类，一般如整车、精品、配件。

- 汇总依据：可选项：核算类别、库存组织、仓库、记账分类、物料类别。除记账分类外，其他几项相对国机汽车体系来说，没有特别的意义。建议选择`记账分类`，则会按照记账分类进行数据汇总。

- 记账标志：空、是、否。建议默认为空，这样即可包含已生成凭证的，也可包含没生成凭证的。请结合实际选择。

- **单据状态**：区分为空/提交/审核；空，则显示所有状态的单据数据；提交，则显示提交状态的单据数据；审核，则只显示审核状态的单据数据；

  一般这里选择：审核。因为只有单据状态为审核，才会真正影响库存。

- 显示条件：可根据结存数量等于零、不等于零、大于零、小于零进行筛选。

- **只显示汇总行**：如果勾选，则报表数据，只显示汇总行，不再按物料明细列示，请结合实际。

- **显示不参与核算的事务类型**：本报表只能查询库存类型为普通的数据汇总，不能查询库存类型为其它、库存类型为赠品的数据汇总。

  因此，本条件，实际上就是区别是否包含组别四逐步禁用组的数据。

  勾选则包含不参与核算的事务类型的数据（即期初、发生、结存，均有组别一、组别四的数据），不勾选则不包含不参与核算的事务类型的数据（即期初、发生、结存，均只有组别一）。

  请重点理解这个条件，这个条件是我们筛选异常数据的重要依据。

- 不显示成本价调拨出入库单：这个主要用于本报表中的数据，与财务科目余额表的数据，核对发生额。因为成本价的调拨入库单和成本价的调拨出库单，我们不需要生成凭证。一般来说，收入应当与科目的借方相等，发出应当与科目的贷方相等。

- 精度设置：

  数量显示精度：一般设置为3。


::: danger 异常数据方面--对比核查组别四异常数据

- 通过存货收发存汇总表，其他条件保持一致，勾选与不勾选`显示不参与核算的事务类型`，分别导出数据至EXCEL，再在EXCEL中，对期初、收入、发出数据进行VLOOKUP，查询两组EXCEL的差异，数量、金额不相等的物料，则为异常数据。
- 期初数据，如果有差异，一般就是组别四逐步禁用组的数据，需要处理。
- 收入和发出，如果有差异，一方面是因为有组别四逐步禁用组的数据，这个需要处理。一方面是因为有库存移动单的数据，这个可以忽略，因为是正确的。
- 核查异常数据时，建议在库管员暂时不操作库存单据时查询并异出，避免因业务还在进行中，查询的数据总是在变化中，干扰了数据核对，造成不必要效率降低。

:::

#### 4.3.3 存货收发存明细表

**报表路径**：`〖财务会计〗-〖存货核算〗-〖报表分析〗-〖存货收发存明细表〗`

**主要功能**：

**统计`单一财务组织`，在`指定期间`范围内的库存业务（`仅包含库存类型为普通，即组别一、组别四`）发生数据**。

功能与存货收发存汇总表一致，只不过会把发生明细逐行显示，以了解和掌握指定数据的全过程。

**可通过存货收发存汇总表，联查同条件的存货收发存明细表，通过存货收发存明细表，可联查具体的业务单据**。

**查询示意图**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-22.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-22.png',
          
        ]
      }
    }
  }
</script>
```

:::



**主要条件**：

查询条件，可结合字面意思，及参考前述存货收发存汇总表的描述，本处不再展开描述。

::: danger 特别提醒

- 一般不建议使用该报表，建议使用库存类型收发明细表。因为后者涵盖了前者的内容。
- 存货收发存明细表，仅是显示库存类型为普通的数据。
- 库存类型收发明细表，不只可以显示库存类型为普通的数据，还可以显示库存类型为其它、库存类型为赠品的数据，因此更全。
- 如果遇到异常数据，仅看存货收发存明细表，可能会干扰判断，做出不正确的调整或不能发现错误。

:::

**报表结果**：

当我们得到结果后，请结合报表中的期初、收入、发出、结存，检查数据的异常。

比如组别四逐步禁用组的数据，如果在收入列、发出列金额字段有值，则显著不正确。

比如组别一普通组的数据，如果在收入列、发出列金额字段没有值，则要考虑该物料计价方法是不是有错。

本报表中，事务类型名称含`逐步禁用`字样的为组别四，其他的为组别一的数据。

一般建议核查异常数据时，会计期间从，请选择库存系统启用期间，会计期间至为当前期间。

### 4.4 库存账龄分析表

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存报表〗-〖库存账龄分析表〗`

**主要功能**：

**统计`单个财务组织`，以`指定期间期末库存`为基准，核查`结存数量大于零`的结存金额，按`库龄天数的设定`，核查所有结存金额的库龄时间**。

::: danger 特别强调

- 本报表不包含结存数量为0但结存金额有值的数据；
- 本报表不包含结存数量为负但结存金额有值的数据；同时，结存数量为负，也是显著异常的数据。

:::

**查询示意图**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-25.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-25.png',
          
        ]
      }
    }
  }
</script>
```

:::



**主要条件**：

报表会因库龄天数的设定，呈现不同的结果。每一组库龄天数都会有数量、金额。

注意，所有条件是`且`的关系，即查询所得数据同时满足设置的条件。

- 期末库存：默认当前期间，结合实际选择。

  即时库存：不选择此项。

  **库存管理必须结账**，才能查询得到数据，也即只能查询当期以前历史期间的数据。比如当期在2022年4期，则能准确查询数据的最大期间为2022年3期。

- **统计级次**：系统共有6项：仓库、库位、项目号、批次、辅助属性、跟踪号，**禁止勾选任何一项**。如果勾选，则会按这个勾选的维度呈现数据。

- **是否统计如下单据**：系统共有4项：销售退回是否参与、领料退回是否参与、其他出库退回是否参与、跨仓库调拨是否参与，**禁止勾选任何一项**。

- **库龄天数**：请严格按照本部资产财务部的划分库龄区段的要求，设置好库龄天数。

- 精度设置：

  数量显示精度：一般设置为3；

  辅助数量显示精度：一般设置为3；

  单位显示精度：一般设置为4-6；

  金额显示精度：一般设置为2。

::: tip 提示

- 强烈建议把已设定好的查询条件，保存为方案，方便快捷使用，避免要反复设置查询条件，特别是库龄天数、是否统计如下单据。后续一般只需要修改下期间即可。

:::

### 4.5 即时库存

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存查询〗-〖即时库存查询〗`

**主要功能**：

**统计`若干库存组织`，指定查询条件的实时存货结存**。

**查询示意图**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-28.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-28.png',
          
        ]
      }
    }
  }
</script>
```

:::

::: danger 特别强调

- 本报表只能显示`实时结存数量`，无法查询历史日期的结存数量、无法查询任何时点的金额。

- 库存数量和金额要发生入库或出库，**必须在同组内发生**，否则将导致数量、成本出错，或者提示库存不足。

- 普通组的单据，必须有数量和实际成本（调整金额），否则是错误的；

  其它组、赠品组、逐步禁用组，必须有数量，且必须实际成本（调整金额）为0，否则是错误的；

- 库存数量的增加或减少，是以 **`物料`+`批次`+`计量单位`+`基本计量单位`+`辅助计量单位`+`仓库`+`库位`+`库存类型`+`库存状态`+`库存组织`** 的组合维度来增加或减少的，因此当组合维度不一致时，增加时会形成新的组合数据，减少时就可能导致无法出库，提示库存不足。库存金额，同理。

- **最常见的出错，大多是因为`忽略三组计量单位、库存类型`**，其他维度比较好理解（如物料、仓库、库位）或基本不用（批次）或所有均一致（如库存状态）不太会出错。

- 当在做减少库存数量的操作时（比如入库负数、出库正数），如果看似有库存，但就是无法出库，提示库存不足，请按上述组合维度，检查单据上的各数据是否正确。

  库存类型在单据上不直观显示，请通过名称判断：

  库存类型：`其它`，对应单据上的事务类型名称包含`库存类型为其它`字样；

  库存类型：`赠品`，对应单据上的事务类型名称包含`库存类型为赠品`字样；

  除上述`其它`，`赠品`外的，其他单据均为`普通 `，不管是组别一、组别四，其库存类型都是普通。

  但要注意，部分门店，零成本的单据，没做到组别二（库存类型为其它）或组别三（库存类型为赠品），而是做到组别一，然后出库时又以组别四出库，则会导致成本核算错误。组别四的业务，不允许再有结存数量、结存金额。禁止发生新业务，只允许发生调整历史错误的操作。

:::

### 4.6 报表区别

#### 4.6.1 三大汇总表之间的区别

明细表数据逻辑与汇总表一致，因此就不再赘述。

- **区别一：包含范围不同**

  1. 库存类型收发汇总表：包含所有库存类型的数据，即包含组别一普通组、组别二其它组、组别三赠品组、组别四逐步禁用组。

     勾选显示库位，则本期收入和发出包含库位移动单的数据，如果不勾选则不包含库位移动单的数据。

  2. 普通物料收发事务汇总表：只包含库存类型为普通的数据，即组别一、组别四。

     不管是否勾选显示库位，汇总时均包含库存移动单的数据。

  3. 存货收发存汇总表：只包含库存类型为普通的数据，即组别一、组别四。也包含库存移动单的数据汇总。

- **区别二：功能侧重点不同**

  1. 库存类型收发汇总表：`主要基于库存类型做数据汇总及展示`。

     支持库存类型汇总。不支持通过条件定义是否包含不参与核算的。

  2. 普通物料收发事务汇总表：主要基于库存类型为普通的数据汇总及展示。可按收发类型展示数据。

     **复选项`期初包含不参与核算的库存`，影响期初发生，但不影响收入和发出**，进而影响结存。

     勾选，则期初包含不参与核算的库存；

     不勾选，则期初不包含不参与核算的库存。

     注意，不管是否勾选，收入和发出均包含不参与核算的。

  3. 存货收发存汇总表：主要基于库存类型为普通的数据汇总及展示。

     **复选项`显示不参与核算的事务类型`，影响期初、收入、发出**，进而影响结存。

     勾选，则期初、收入、发出，均包含不参与核算的；

     不勾选，则期初、收入、发出，均不包含不参与核算的。

     库位移动单视为不参与核算，因为是仓库内调拨。

- **区别三：汇总侧重点不同**

  库存类型收发汇总表：**可按库存类型汇总**，如普通、其它、赠品。可以按仓库及库位汇总。

  普通物料收发事务汇总表：可按物料分类汇总，按主数据物料分类汇总。可以按仓库及库位汇总。

  存货收发存汇总表：**可按记账分类分类汇总**，如整车、精品、配件。不可以按仓库及库位汇总。

- **区别四：显示条件侧重点不同**

  库存类型收发汇总表：支持7种显示条件，门店可充分利用此功能，实现更多场景的数据筛选。如第3种：收入和发出都为0不显示，可以快速查询有发生库存变化的物料，延伸开，就可以基于这些物料做每日动态盘点。

  普通物料收发事务汇总表：支持8种显示条件，门店可充分利用此功能，实现更多场景的数据筛选。

  存货收发存汇总表：支持按结存数量与零的大小关系筛选。同时支持无收发数据不显示、支持是否统计成本价的调拨出入库单。

- **区别五：时间维度不同**

  库存类型收发汇总表：按日期查询。比较灵活，从期间第1日至期间最后1日，则相当于按期间查询。

  普通物料收发事务汇总表：按日期查询。比较灵活，从期间第1日至期间最后1日，则相当于按期间查询。

  存货收发存汇总表：按期间查询。无法区别日期。

#### 4.6.2 三大汇总表与即时库存表的区别

不同点：

- 区别一：时点不同

  三大汇总表，可以查询历史时点的数据。强调指定日期/期间范围。

  即时库存表，只能查询当前实时时点的数据。强调实时。

  ::: danger 特别强调

  - 即时库存表，是当前实时的结存。不管库存单据的业务日期是哪日，只要单据审核了，就影响即时库存。即使业务日期做到还未到的日期中（即比当日晚的日期：比如因为提前结账、比如操作人员误操作选择还未到的日期、比如操作人员故意选择还未到的日期）。可通过库存类型收发汇总表（日期从选择当日的下一日或指定的更后的日期、日期至选择较远的日期），查询看看是否有发生数据，如有，且不是因为提前结账，则为异常数据。
  - 三大汇总表，则基于选定的日期至的日期/会计期间至的期间，计算结存数据。在这之后的数据，不会被统计进入报表。

  :::

- 区别二：即时库存不包含金额。

  三大汇总表，可以同步显示金额。是否显示金额，支持权限设置。

  即时库存表，不显示金额。

- 区别三：包含数据范围不同。

  库存类型收发汇总表，包含组别一、组别二、组别三、组别四的数据。

  普通物料收发事务汇总表，只包含组别一、组别四的数据。

  存货收发存汇总表，只包含组别一、组别四的数据。

  即时库存表，包含组别一、组别二、组别三、组别四的数据。

相同点：

- 当前不再操作库存单据时，且实际没有当前时点之后的库存单据。则查询的即时库存，会与库存类型收发汇总表指定查询条件的结存数据一致（日期至：选择当日或当日之后的日期，勾选显示库位）。即，比如当前是10日，没有10日之后业务日期的单据，则日期至选择为10日或之后的日期。否则数据可能不一致。

- 当前不再操作库存单据时，但实际有当前时点之后的库存单据。则查询的即时库存，会与库存类型收发汇总表指定查询条件的结存数据一致（日期至：选择有发生数据的未来日期之后的日期，勾选显示库位）。即，比如当日日期是10日，有笔单据的发生日期为还未到的15日，则日期至选择15日或之后的日期。否则数据可能不一致。但这种改到未来日期的操作，只有提前结账的场景下才允许，且只是修改到下期的第1日，禁止修改到除这第1日之外的其他未来日期，否则视为数据异常。

- 由于可能有库存类型为其它、库存类型为赠品的数据，所以尽量用库存类型收发汇总表与即时库存对比。避免数据少了，对核对产生干扰。

- 如果发现如上查询并对比后，不相等，请对不相等的物料进行【刷新即时库存】，刷新后再对比，应该就一致了，如果还不一致，联系本部予以协助查询。

- **`刷新即时库存的方法`**：

  **操作路径**：`〖精品配件管理〗-〖库存管理〗-〖库存查询〗-〖即时库存查询〗`

  进入即时库存查询列表，同时按住【Alt】+【i】，在工具栏中会显示按钮【刷新库存】，点击该按钮，输入`库存组织`、`物料`，点刷新，等待提示完成，即可修正即时库存。



## 五、如何查询出显著异常的数据

通过上述各小节的描述，了解了库存单据、事务类型、成本核算的基本算法、常用的报表，就到了本章节重点：如何查询显著异常数据、如何处理异常数据。

显著异常，是指数据不符合我们约定的正确规范，且容易直观查询并马上确定的。

非显著异常数据，是指数据不符合我们约定的正确规范，但不容易直观确定，需要查询收发明细，核对数据发生过程，才能确定哪笔异常的。

下述内容，写起来很多，但实际上日常查询熟练后，要查询出来显著异常的数据，操作其实很快，同时建议把常见的查询设置为方案，以便以后使用，只需要小改动（比如修改日期）即可马上查询。

### 5.1 异常数据的约定

导致数据异常的原因特别多，为便于识别异常数据，我们对异常数据的特征做如下约定：

**结存数据异常**：

- 结存：组别四逐步禁用组不允许有结存数据，即不允许有结存数量、结存金额。如有，则视为异常。查询方法参见下述<5.2>和<5.3>的描述。

- 结存：组别二其它组的结存数据中，允许有结存数量、但不允许有结存金额。如有结存金额，视为异常。查询方法参见下述<5.4>的描述。

- 结存：组别三赠品组的结存数据中，允许有结存数量，但不允许有结存金额。但建议，不要再使用组别三，请把结存数量冲掉，转入组别二。如有结存金额，视为异常。查询方法参见下述<5.4>的描述。

- 结存：组别一普通组的结存数据中，有数量就应当有金额，有金额就应当有数量。

  如果只有金额，没有数量，则视为异常。

  如果只有数量，没有金额，需要考虑是不是有组别四的业务？不管是不是组别四，只要普通组结存数量不等于0但结存金额等于0，均是异常。

  注意查询报表时，不要勾选显示仓库、不要勾选显示库位，否则会影响判断，因为调拨、加权核算的原因，可能金额存在A库位、数量存在B库位，但合并后是对的，这种数量金额错开仓库或库位的，可以忽略。

  查询方法参见下述<5.5>的描述。

- 结存：不管哪种库存类型的结存，结存数量为负、或  结存金额为负的，视为异常。查询方法参见下述<5.6>的描述。

由于发生单据已发生了，我们可能已无法再更改单据，因此最终是以结存数据是否有异常而进行判断。

**日常发生数据异常**：

- 发生：组别二其它组，发生时有金额，视为异常。如果后续调整纠正了错误，总的正负抵销了，视为正常。查询方法参见下述<5.7>的描述。

- 发生：组别三赠品组，发生时有金额，视为异常。如果后续调整纠正了错误，总的正负抵销了，视为正常。查询方法参见下述<5.7>的描述。
- 发生：组别四逐步禁用组，发生时有金额，视为异常。如果后续调整纠正了错误，总的正负抵销了，视为正常。查询方法参见下述<5.7>的描述。
- 调拨业务：任何跨仓库调拨（异价）均为异常。
- 调拨业务：任何库存调拨单，累计调入数量 不等于 累计调出数量，则视为异常。
- 成本调整单：任何入库成本调整单，非系统核销自动生成，则视为异常。如果后续调整纠正了错误，总的正负抵销了，视为正常。
- 发生：组别一普通组的采购入库单据，其单位实际成本与供应商提供的实际的单位成本有差异（因四舍五入原因导致的差异视为正常），视为异常。该异常不显著，需要核查明细才能发现。
- 发生：组别一普通组的采购入库单据，其前后采购入库的单位实际成本一致（因四舍五入原因导致的差异视为正常），但本笔入库成本明显高于或低于前后采购入库单，视为异常，可能是采购订单/采购入库单上的含税单价/单价错误了。该异常不显著，需要核查明细才能发现。
- 发生：组别一普通组的出库单据，其单位实际成本明显高于或低于前后出库单据的单位实际成本的，视为异常。该异常不显著，需要核查明细才能发现。
- 发生：组别一普通组的出库单据，其单位实际成本为0，视为异常。除非该物料入库和出库均为0，且计价方法为加权平均法。但这种操作容易导致错误，应当禁止。该异常不显著，需要核查明细才能发现。

### 5.2 查询期初组别四（逐步禁用请不要再使用）的异常数据

**核查报表**：`普通物料收发事务汇总表`

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存报表〗-〖普通物料收发事务汇总表〗`

**确定异常物料的参考步骤**：

- 设置报表查询条件：
  1. 库存组织：选择指定门店；
  2. 日期从：选择当期1日；
  3. 日期至：选择当前日期；
  4. 勾选/不勾选：`期初包含不参与核算的库存`；勾选导一次、不勾选导一次。这是本小节的关键条件。
  5. 其它条件，按默认不动。
- **勾选**`显示不参与核算的事务类型`，得到报表数据后，在列示的数据的任一位置，右击，显示右键菜单，选择【导出到Excel】，请自行记住Excel存放的位置；假设为A表。
- **不勾选**`显示不参与核算的事务类型`，得到报表数据后，在列示的数据的任一位置，右击，显示右键菜单，选择【导出到Excel】，请自行记住Excel存放的位置；假设为B表。
- 在A表上，对期初数量、期初金额，以物料编码为关键字段，通过Vlookup函数，把B表的期初数量、期初金额，取到A表，并计算期初数量的差异、期初金额的差异。
- 在B表上，对期初数量、期初金额，以物料编码为关键字段，通过Vlookup函数，把A表的期初数量、期初金额，取到B表，并计算期初数量的差异、期初金额的差异。
- 得到结果后，筛选数量差异列值不等于０的、以及#N/A的数据，并对单元格做颜色标记；筛选金额差异列值不等于０的、以及#N/A的数据，并对单元格做颜色标记；
- **两组表格中，`数量差异列或金额差异列不等于0或为#N/A`，则为异常数据**。

::: tip 提示

- 假设当日是4月10日，则可以日期从选择为4月11日，日期至也选择为4月11日，即可查询截至当前最新的数据，再核对A表和B表。（该条不生效，参见下述特别说明）

- 不管哪种查询，一定要注意，应当在任何人暂停操作库存单据的情况下，查询和导出数据，避免因业务还在发生中，干扰了数据核对。

- 该方法，可以核对出期初有组别四的数据。

- 该异常数据，较常见，特别是库管人员在出库，只要出库审核时报错，根本不管是否有此组别的数据入库，也不核查分析为什么出库审核时会报错，就随意的选择组别四的事务类型出库，导致数据异常。

- 组别四逐步禁用组，不允许再发生新业务，除非是调整遗留的结存数据。调整完后，禁用组别四的事务类型，则该异常数据，应该不会再有。

:::

::: danger 特别说明

- 上述提示中的当日是4月10日，则可以选择4月11日的指引，目前暂时不生效，请注意。 当前，这个报表的期初是指后台的库存余额表的期初。且期初定义是根据日期从、当前期间来判定的。

- 如当前期间是4月，如日期从是4月1日（含）之后的，不管是诸如4月10日、5月10日，则该期初都是4月1日的期初。

- 如当前期间是4月，如日期从是4月1日（不含）之前的，则按此日期从所在期间取期初，比如2月10月，则期初为2月1日的期初、3月10日则为3月1日的期初。
- 不生效的问题点，已反馈给金蝶，待金蝶修复后，可继续按指导操作；在未修复前，参照此特别说明。

:::

### 5.3 查询当期组别四（逐步禁用请不要再使用）的异常数据

**核查报表**：`存货收发存汇总表`

**报表路径**：`〖财务会计〗-〖存货核算〗-〖报表分析〗-〖存货收发存汇总表〗`

**确定异常物料的参考步骤**：

- 设置报表查询条件：
  1. 财务组织：选择指定门店；
  2. 会计期间从：选择当期；
  3. 会计期间至：选择当期；
  4. 勾选/不勾选：`显示不参与核算的事务类型`；勾选导一次、不勾选导一次。这是本小节的关键条件。
  5. 其它条件，按默认不动。
- **勾选**`期初包含不参与核算的库存`，得到报表数据后，在列示的数据的任一位置，右击，显示右键菜单，选择【导出到Excel】，请自行记住Excel存放的位置；假设为A表。
- **不勾选**`期初包含不参与核算的库存`，得到报表数据后，在列示的数据的任一位置，右击，显示右键菜单，选择【导出到Excel】，请自行记住Excel存放的位置；假设为B表。
- 在A表上，对期初数量、期初金额、收入数量、收入金额、发出数量、发出金额，以存货编码为关键字段，通过Vlookup函数，把B表的期初数量、期初金额、收入数量、收入金额、发出数量、发出金额，取到A表，并计算对应列的差异。
- 在B表上，对期初数量、期初金额、收入数量、收入金额、发出数量、发出金额，以存货编码为关键字段，通过Vlookup函数，把A表的期初数量、期初金额、收入数量、收入金额、发出数量、发出金额，取到B表，并计算对应列的差异。
- **两组表格中，`数量差异列或金额差异列不等于0或为#N/A`，则为异常数据**。

::: tip 提示

- 不管哪种查询，一定要注意，应当在任何人暂停操作库存单据的情况下，查询和导出数据，避免因业务还在发生中，干扰了数据核对。
- 该方法，可以核对出期初、收入、发出有组别四的数据。
- 该异常数据，较常见，特别是库管人员在出库，只要出库审核时报错，根本不管是否有此组别的数据入库，也不核查分析为什么出库审核时会报错，就随意的选择组别四的事务类型出库，导致数据异常。
- 组别四逐步禁用组，不允许再发生新业务，除非是调整遗留的结存数据。调整完后，禁用组别四的事务类型，则该异常数据，应该不会再有。
- **为简便，也可以直接核对期末数量、金额的差异，如有异常的，需要关注**。

:::

### 5.4 查询组别二（库存类型为其它）/组别三（库存类型为赠品）的异常数据

**核查报表**：`库存类型收发汇总表`

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存报表〗-〖库存类型收发汇总表〗`

**确定异常物料的参考步骤**：

- 设置报表查询条件：
  1. 库存组织：选择指定门店；
  2. 日期从：选择当期第1日；
  3. 日期至：选择当前日期；
  4. 库存类型汇总：勾选；
  5. 单据状态：审核。
  6. 其它条件，按默认不动。
- 得到报表数据后，**展开`其它`、`赠品`的汇总行**，以便显示明细物料，在列示的数据的任一位置，右击，显示右键菜单，选择【导出到Excel】，请自行记住Excel存放的位置。
- **查看`库存类型为其它、库存类型为赠品的行的期初、收入、发出，金额列是否有值`。有值的，则为异常数据**。

::: tip 提示

- 不管哪种查询，一定要注意，应当在任何人暂停操作库存单据的情况下，查询和导出数据，避免因业务还在发生中，干扰了数据核对。
- 该方法，可以核对出期初、收入、发出中其它、赠品异常的数据。
- 只要不在这两组事务类型的单据中手工指定实际成本，一般不会产生异常数据。

:::

### 5.5 查询结存无数量有金额的异常数据

**核查报表**：`库存类型收发汇总表`

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存报表〗-〖库存类型收发汇总表〗`

**确定异常物料的参考步骤**：

- 设置报表查询条件：
  1. 库存组织：选择指定门店；
  2. 日期从：选择当期第1日；
  3. 日期至：选择当前日期；
  4. 库存类型汇总：勾选；
  5. 单据状态：审核。
  6. 其它条件，按默认不动。
- 得到报表数据后，**展开`普通`、`其它`、`赠品`的汇总行**，以便显示明细物料，在列示的数据的任一位置，右击，显示右键菜单，选择【导出到Excel】，请自行记住Excel存放的位置。
- **筛选`结存数量为空或0，且结存金额列有值的数据`，即为异常数据**。
- **筛选`库存类型为普通`，且`结存数量有值，但结存金额为空或0`的数据，一般也为异常数据**。

::: tip 提示

- 不管哪种查询，一定要注意，应当在任何人暂停操作库存单据的情况下，查询和导出数据，避免因业务还在发生中，干扰了数据核对。
- 该方法，可以查询无数量有金额的异常数据。**库存账龄分析表中的合计数与库存报表结存金额（或财务余额）有差异，基本上是因为存在无数量有金额的异常数据**。
- 该异常数据，较常见，也无法完全杜绝。主要原因就是采购入库不规范或输入错误的单价，采购单价反复波动较大，计价方法不是实时移动加权平均法，四舍五入等。
- 注意，查询本异常数据时，报表查询条件，不要勾选显示仓库、不要勾选显示库位，否则会干扰判断。

:::

### 5.6 查询结存负数量的异常数据

**核查报表**：`库存类型收发汇总表`

**报表路径**：`〖精品配件管理〗-〖库存管理〗-〖库存报表〗-〖库存类型收发汇总表〗`

**确定异常物料的参考步骤**：

- 设置报表查询条件：
  1. 库存组织：选择指定门店；
  2. 日期从：选择当期第1日；
  3. 日期至：选择当前日期；
  4. 库存类型汇总：勾选；
  5. 单据状态：审核。
  6. 其它条件，按默认不动。
- 得到报表数据后，**展开`普通`、`其它`、`赠品`的汇总行**，以便显示明细物料，在列示的数据的任一位置，右击，显示右键菜单，选择【导出到Excel】，请自行记住Excel存放的位置。
- **筛选`结存数量为负的数据`，即为异常数据**。

::: tip 提示

- 不管哪种查询，一定要注意，应当在任何人暂停操作库存单据的情况下，查询和导出数据，避免因业务还在发生中，干扰了数据核对。
- 该方法，可以查询结存数量为负的异常数据。一般来说，这种异常数据很少见，因为物料禁止允许负结存。个别物料如允许负结存，请联系本部处理。
- 注意，查询本异常数据时，报表查询条件，不要勾选显示仓库、不要勾选显示库位，否则会干扰判断。

:::

### 5.7 查询日常单据不参与核算但有成本的异常数据

**查询单据**：【采购入库单】、【其他入库单】、【其它出库单】、【销售出库单】。

**查询条件**：

- 自定义条件：

  事务类型 类似  逐步禁用,库存类型为其它,库存类型为赠品  且

  实际成本 不等于  0

- 业务日期从：选择当期的1日；业务日期至：选择当期的最后1日；如果是查询所有的，则业务日期均可以为空。

- 其他条件，请结合实际。

该查询结果当期的不应该有任何一条数据。历史期间的数据，如已正负调整，则视为正常。如果历史数据未被调整，则需要尽快处理。

**查询单据**：【调拨出库单】、【调拨入库单】

**查询条件**：实际上和上述一样。但因为过滤条件中没有实际成本字段，无法直接按上述条件查询，但我们可以变通操作。查询事务类型名称中含`其它`字样的所有调拨出库单、调拨入库单，在列表序时簿中，选择任一行数据右击，单击【设置】，在常规选项卡中找到`实际成本`字段，把隐藏列的勾去掉，确定。则列表会显示实际成本字段，双击字段可排序 ，查看是否该字段有值。如有值，且事务类型名称含`其它`则为异常。

::: tip 提示

- 不管哪种查询，一定要注意，应当在任何人暂停操作库存单据的情况下，查询和导出数据，避免因业务还在发生中，干扰了数据核对。
- 实际上日常发生单据，会影响结存数量、结存金额，我们可以使用上述方面，核查出异常数据。

:::

### 5.8 查询调拨业务的异常数据

**查询单据**：【库存调拨单】、【调拨出库单】、【调拨入库单】。

**常见异常**：

- 异常数据一：业务类型不等于`跨仓库调拨（成本价）`的这三类单据，均为异常。

- 异常数据二：事务类型类似`其它`且实际成本不等于0的调拨出库单、调拨入库单，均为异常。

- 异常数据三：单据状态不等于关闭的库存调拨单，均为异常。

  导致单据非关闭状态的原因：

  - 累计调入数量  等于 累计调出数量，但这两者不等于数量。
  - 累计调入数量  不等于 累计调出数量，这点问题严重，等于库存丢失了，有出无入。禁止出现此场景的异常数据。

### 5.9 查询入库成本调整单的异常数据

**查询单据**：【成本调整单】。

**查询条件**：

- 自定义条件：

  业务类型  等于  入库  且

  创建类型  不等于  采购-自动生成

- 其他条件，请结合实际。

该异常数据的调整方法：做同样的手工入库成本调整单，调整金额与原错误的调整金额相反。即原错误的调整金额是正，则冲调的单据其调整金额为负；反之亦然。

## 六、异常数据分析步骤

当我们通过上述<5.2>至<5.7>的描述，查询到异常的物料后，我们均可以通过`库存类型收发明细表`核查该物料自启用期间至当前的所有发生明细，以帮助我们分析异常数据是如何产生的。

实际上，异常数据的归根到底就是两种错误：单据事务类型错误、单据成本核算错误。

### 6.1 库存类型收发明细表查询明细

通过`库存类型收发明细表`查询收发明细，查询条件：

1. 库存组织：本门店；
2. 日期从：**`选择库存系统启用期间的第1日`**；
3. 日期至：选择当前日期；
4. 物料编码从：选择前述异常数据行的物料；
5. 物料编码至：同物料编码从，即每次只查询同一物料的收发明细；
6. 显示期初与结存：勾选。
7. 其它条件，按默认。
8. 得到报表数据后，导出至Excel。

### 6.2 分析步骤及问题特征

#### 6.2.1 明细数据分组

- 对导出的Excel，按事务类型分组筛选

  组别二其它组：事物类型名称含`库存类型为其它`；

  组别三赠品组：事物类型名称含`库存类型为赠品`；

  组别四逐步禁用组：事物类型名称含`逐步禁用`；

  除去最后的合计行，其他行（包含期初），为组别一普通组。

#### 6.2.2 核查事务类型方面的错误

- 分别检查组别二其它组、组别三赠品组、组别四逐步禁用组的列数据，比较`收入列数量`合计与`发出列数量`合计、比较`收入列金额`合计与`发出列金额`合计，并得到每组别的结存数量和金额（因结存数量和金额是所有组别的合计，因此需要我们自行按组别区别）

- 组别二、组别三、组别四，期初（为0）+  每组收入数量合计  -  每组发出数量合计  =  每组结存数量；

  `特征一`：**<u>当结存数量为负时，则为显著异常，特别是组别四容易出现，需要尽快纠正</u>**。

  `特征二`：**<u>当结存数量为正时，如组别三、组别四有结存数量，需要冲减转到组别二。即后续都不再使用组别三、组别四的事务类型</u>**。

- 组别二、组别三、组别四，期初（为0）+  每组收入金额合计  -  每组发出金额合计  =  每组结存金额；

  `特征三`：**<u>这三组，发生、结存，金额均不得有值，有值则为异常需要冲减调整</u>**。

- 组别一普通组的结存数量  =  报表最后一行的结存数量  -  上述三种手工计算得出的结存数量  =  期初数量  +  组别一收入数量  -  组别一发出数量

- 组别一普通组的结存金额  =  报表最后一行的结存金额  -  上述三种手工计算得出的结存金额  =  期初金额  +  组别一收入金额  -  组别一发出金额

- 请务必理解结存数量、结存金额的计算逻辑，也是我们判断数据是否异常的重要参考。

- **如果每组别的收入数量  >  发出数量，则结存数量包含该组别的数量，结存数量扣除组别二、组别三、组别四后的数量为组别一的结存数量，结存金额应当为组别一的结存金额（因为组别二、组别三、组别四都不应当有金额，如有需要尽快调整）**。

  **如果每组别的收入数量  <  发出数量，则为显著异常，需要尽快调整**。

#### 6.2.3 核查成本核算方面的错误

本小节主要描述组别一普通组的收入成本、发出成本、结存成本。（在描述中，可能会穿插成本、金额等名词，这是同一概念，都是指单位实际成本、实际成本（实际成本=单位实际成本*数量））

组别二、组别三、组别四，在入库、出库时，均不得有实际成本（报表上体现为金额）。上述事务类型方面已描述，就不再重复描述。

##### 6.2.3.1 收入（入库单据）

- 收入成本：一般来说，同一供应商，在一定连续的时间范围内，其提供的同种物料，采购价格应该保持不变，或基本不变。

  当然，因紧急采购订单等特殊合理原因，可能价格波动稍大，类似此种特殊合理原因，不在我们讨论范围内，其视同正常。

  因此，在我们核查库存类型收发明细表，收入列数量、金额时，当出现价格波动较大的明细数据时，并排除特殊合理订单偶尔波动较大外，非特殊或不合理的价格波动较大，就需要特别关注，结合实际判断是不是正常。

  当同一物料确实有多个供应商，然后价格还不一样，应当只向价格低的进行采购。除非偶尔的紧急订单。

  禁止实际不是同一物料，为图方便但硬生生的在系统中使用同一物料进行业务流转，这种管理方式是不允许的。

  常见不正常的波动较大的：

  - `特征四`：**虚构采购：非真实采购**，因盘盈等原因多出的物料，虚做采购入库、其他入定，指定类似0.01的单位成本。

    非有价格的采购业务、非采购业务，且非销售退货、非领料退货业务，需要增加库存时，一般应以`其他入库单承载，事务类型使用组别二其它组，实际成本为0`的方式录入系统。后续通过精品销售出库、维修出库、内部领用出库等出库形式消耗该物料时，事务类型请选择名称中含`库存类型为其它`的。

  - `特征五`：**数量与金额维护反了**，导致数据异常。

    这种问题，必然导致物料结存数量不对、并影响该物料的出库成本。该问题，应当当日即可发现（即通过每日动态盘点应当核查出来系统库存与实际库存有差异）。

  - `特征六`：**数量与实际相符，但采购价格错误录成了其他的金额**（如看错小数位导致扩大10倍或缩小10倍，或多输入少输入了数字），导致成本异常。

  - `特征七`：**采购退货与原采购入库单价不一致**（四舍五入原因导致的视为一致），一般来说，采购退货应当与原采购单价一致，不得虚高或虚低。如果是折价退还给供应商，应当经过内部审批手续，确保折价退货获得合规合理的授权，否则因个人原因导致的采购退货价格比原采购价格低，需要追责。

  - `特征八`：不得为了所谓的方便，**实际不为同一物料的，在系统中硬生生的使用同一物料进行入库和出库**，必须绝对禁止！！！应分别建立不同的物料进行入库和出库操作。


##### 6.2.3.2 发出（出库单据）

- 发出成本：出库成本，均是通过系统自动的核算功能，计算出库单上的实际成本。

  核算的基本逻辑，可简化理解为：按事务类型分组，并基于时间顺序，按物料计价方法核算每个物料的出库成本。

  根据实时移动加权平均法，成本核算的逻辑（该公式是我简化的表述：存货单位成本 =  上笔业务后结存金额  /  上笔业务后结存数量），每一笔出库成本都会受上一笔同组事务类型的入库单据的数量和实际成本、出库单据的数量和实际成本的影响，上一笔不正确，必然会影响本笔出库成本。每一笔出库的成本，其单位实际成本、实际成本均应在合理区间，其单位成本一般应当与最近的采购入库的单价保持一致或近似一致。

  常见的发出成本异常的：

  - `特征九`：组别一普通组的出库单据，其单位实际成本**明显高于或低于前后出库单据的单位实际成本**的。
  - `特征十`：组别一普通组的出库单据，其**单位实际成本为0**，如是计价方法错误，请反馈给本部。所有非整车的物料，其计价方法均应为实时移动加权平均法。
  - `特征十一`：**入库在组别一普通组、出库却在组别四逐步禁用组**，看似很轻松就出库了，没有任何提示，但其会影响组别一普通组的出库单据的实际成本。这种错误在`特征一`中也有描述。
  - `特征十二`：**退库组别与出库组别不一致**。


##### 6.2.3.3 结存

- 结存金额：对结存数量、结存金额，按事务类型分组后，得到实际的组别一的结存数量、结存金额。

  实际上结存数量、结存金额，是根据期初、收入、发出计算得到的，因此如果在期初（即以往的收入、发出）、收入、发出中都正确，结存自然也就正确。

  结存不
  
  - `特征十三`：**结存单位成本与最新采购单价相差较大**。结存单位成本  =  结存金额  /  结存数量。强调：是扣除组别二、组别三、组别四后的数据，按此公式计算。单位成本，一般来说，应当与最近的采购单价一致或近似一致。如果不一致，应当注意排查是否有入库或出库错误。
  - `特例十四`：**负结存数量或负结存金额**。任何组别的结存数量不应当为负，或任何组别的结存金额不应当为负。这种错误在`特征一`中也有描述。
  - `特例十五`：**结存数量为0但结存金额不为0**。
  - `特征十六`：实际上本特征属于特征十五，但为了便于表述，另约定为特征。**入库和出库都没有问题，但四舍五入原因，虽然结存数量为0但结存金额不为0**。得到实际的组别一普通组的结存数量、结存金额后，因四舍五入，其组别一普通组结存数量为0，但结存金额有值。

## 七、常见异常数据的调整方法

当通过上述方法，判断出来哪些物料，哪些单据出现异常数据后，则需要及时进行纠正调整。

### 7.1 调整原则和核心目的

- **调整原则**：`原来如何错误的，则先以同样错误的方式并以相反金额冲掉原来的单据，再按正确的操作补调单据`。为简化操作，如果出库单据仅是实际成本错误，事务类型没有出错，数量没有出错，则可以直接通过出库成本调整单。


- **调整顺序**：

  实际上没有严格的顺序，但因为出库核算每一笔单位成本不允许小于等于0、每一笔单据后的结存数量不允许小于等于0，因此为避免调整无法进行（如提示数量不够、核算中止），建议的调整顺序，参考如下：

  1. **进行事务类型分组，计算每组别的结存数量、结存金额**。

     如组别一有结存数量，结存数量必须大于0，并计算出其结存金额 **`应该`** 是多少。组别一结存金额  =  组别一结存数量  *  合理的结存单位成本（一般为最近的采购不含税单价）。

     如组别二有结存数量，结存数量必须大于0，其结存金额必须为0。

     如组别三有结存数量，结存数量必须大于0，其结存金额必须为0。同时，如有结存数量，应该调整到组别二，即结存数量调整后也要为0。

     如组别四有结存数量，结存数量必须大于0，其结存金额必须为0。同时，如有结存数量，应该调整到组别二，即结存数量调整后也要为0。

  2. **调整增加数量、金额的项**；如出库成本调整单负数调整金额、出库单据负数、入库单据正数，入库成本调整单正数调整金额（一般用不上，除非原有手工的入库成本调整单，现在冲销）。

     入库单据错误的，必须用正负入库单据调整，冲销错误的单据，再补增正确的单据。

     禁止手工入库成本调整单，除非原来冲销错误的手工入库成本调整单。

     出库单据错误的，且仅是实际成本错误的，用出库成本调整单调整，调整多出或少出的成本。

     出库单据错误的，且有事务类型错误的，必须用正负出库单据调整，冲销错误的单据，再补增正确的单据。

  3. **调整减少数量、金额的项**；如出库成本调整单正数调整金额、出库单据正数、入库单据负数，入库成本调整单负数调整金额（一般用不上，除非原有手工的入库成本调整单，现在冲销）。

     入库单据错误的，必须用正负入库单据调整，冲销错误的单据，再补增正确的单据。

     禁止手工入库成本调整单，除非原来冲销错误的手工入库成本调整单。

     出库单据错误的，且仅是实际成本错误的，用出库成本调整单调整，调整多出或少出的成本。

     出库单据错误的，且有事务类型错误的，必须用正负出库单据调整，冲销错误的单据，再补增正确的单据。

  4. 出库成本调整单的调整金额应该调整多少，请结合如下公式：

     `预计调整后的结存`（应该是多少是可以确认的，参见上述1）  =  `调整前的结存`  +  `入库单据`（冲销多少错误补增多少正确是确定的，即拟调整的）+ `入库成本调整单`（冲销多少错误补增多少正确是确定的，即拟调整的）-  `出库单据`（冲销多少错误补增多少正确是确定的，即拟调整的）-  `出库成本调整单`（一般不确定但也很好计算）

     则： 

     拟调整的出库成本调整单  =  调整前的结存  +  入库单据（拟调整的）  + 入库成本调整单（拟调整的）  -  出库单据（拟调整的）  -  预计调整后的结存

  ::: danger 特别提醒

  - 在调整的过程中，注意选择正确的仓库中和库位。
  - 结存金额不对，并不是仅只以出库成本调整单调整完事即可。必须把拟冲销补增的入库单据、拟冲销冲增的出库单据统筹计算后，得到的结存金额还不对，才可以得到拟调整的出库成本调整数据。

  :::

- **核心目的**：确保数据准确，促进业务流畅流转。
- **预期结果**：
  1. 间接促进相关采购核销问题得到修正。
  2. 分组后的结存数量，只有组别一普通组、组别二其它组。
  3. 分组后的结存金额，只有组别一普通组。
  4. **结存单位成本（=  组别一结存金额  /  组别一结存数量）** 合理，与最近采购单价一致或近似一致。
  5. 不存在结存数量为0但结存金额有值的数据。
  6. 不存在结存数量为负或结存金额为负的数据。

### 7.2 异常数据调整示例讲解

现结合前述特征和实际业务，提供调整思路，供大家参考借鉴。

::: danger 特别提醒，请务必记住

- 计价方法是实时移动加权平均法的物料，在使用组别一普通组的事务类型出库时，单据审核时必须有成本，即单位成本字段必须有正数值，如核算出来为0或负的单位成本，这是系统不允许的，就会报错。
- 在用组别一普通组的事务类型进行正常业务出库、调整异常数据时，就要让组别一普通组的出库单据有成本，且其单位成本应该是一个合理的单位成本，不是胡乱给的，也不是虚构的。

:::

#### 7.2.1 出库组别与入库组别或出库前的结存组别不对应（如组别一入库但组别四出库）

因初始化时有数量无金额（初始化默认为组别一普通组）、或因虚构采购入库（采购流程默认为组别一普通组），在本次出库前，组别一普通组有结存数量、但无结存金额，如果继续用组别一的事务类型出库，出库类单据审核时会提示核算失败，导致无法做组别一普通组的出库。

初始化，是指上线前的初始库存数量、库存金额。一般应同时有数量和金额。如果只有数量、没有金额，按组别一进行出库是无法出库的；

虚构采购入库，指定所谓的类似0.01成本；同时出到后面，因为无金额了，按组别一进行出库是无法出库的；

以上两种原因，操作人员没找对方法，而错误用了组别四的事务类型进行出库，从而导致了本小节提到的异常数据。

- **示例参考**：示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili01.xlsx)

::: demo

  ```
  <div class="margin: -50px;padding: 0" style="text-align: center;">
    <el-image 
      :src="url" 
      :preview-src-list="srcList">
    </el-image>
  </div>
  <div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
  <script>
    export default {
      data() {
        return {
          url: '/easpublic/easimg/auto4s-special-104000-shili01-01.png',
          srcList: [
            '/easpublic/easimg/auto4s-special-104000-shili01-01.png',
            
          ]
        }
      }
    }
  </script>
  ```
:::

- **分组数据汇总结果**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili01-02.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili01-02.png',
          
        ]
      }
    }
  }
</script>
```

:::

- **主要错误**：
  - 特征四：虚构采购，指定类似0.01的成本，进而导致产生特征一、特征九、特征十一、特征十五的问题；
  - 特征一：组别四逐步禁用组，结存数量为负数；
  - 特征九：组别一普通组，因为虚构采购，部分出库成本明显低于正常出库成本；
  - 特征十一：**入库在组别一普通组，出库在组别四逐步禁用组**；
  - 特征十五：结存数量为0，结存金额不为0。
- **调整方法**：

  - 调整结存金额：手工新增`出库成本调整单`，调整金额为  -0.02。以增加结存金额至0.03，以便出库时能计算出单位实际成本、实际成本。因为金额小数位为两位，如果不补齐，将导致无法核算成本。
  - 冲销错误出库：手工新增`销售出库单`，业务类型：`211 普通销售退货`，事务类型：`0948 零成本出库（逐步禁用）`（因原错误为`0947`），数量为-3，实际成本为0；注意，原单是三笔错误，现只用一个单据合并进行了调整，送货客户选择本门店名称的客户。
  - 补调正确出库：手工`新增销售出库单`，业务类型：`210 普通销售`，事务类型：`2510 维修出库（一般维修）`（因为其上游为一般维修的工单），数量为3，单位实际成本计算后应为0.01，实际成本计算后应为0.03；注意，原单是三笔错误，现只用一个单据合并进行了补增，送货客户选择本门店名称的客户。
  - 调整的所有单据，生成凭证时，`不过发出商品科目`，借方直接进主营成本/费用/其他业务支出，具体科目，请结合实际业务是维修、还是精品销售、还是配件销售、内部耗用等。
  - 未调整虚构采购入库，因为其与正常采购混在一起，也做了采购核销，因此不再冲减虚构入库。但要说明的是，这里不调，不代表后续仍可以虚构采购入库，后续必须禁止虚构采购入库；
  - 未调整虚构采购入库，本示例不冲销，不代表其他场景不冲销，比如虚拟的采购，一直挂着未核销，实际上如果要冲销虚构采购入库，先得冲销销售出库，再通过组别二补增入库、组别二补增出库。
  - 在进行本小节内容编写时，示例还未得到调整。**本示例调整完后，各组别结存数量、结存金额均为0，符合预期**。

::: tip 提示

- 当在补调正确出库时，可能在审核销售出库单时，报核算中止错误，请对该物料进行`材料出库核算`，一般即可核算出成本，即可审核完成销售出库单。如果仍无法审核，可联系本部予以协助处理。
- 因为是调整历史单据，门店在冲销错误销售出库、补增正确销售出库时，如上示例，并未按三单原始销售出库单的具体客户调整，而是冲销、补增均按组别合并做到一张单据上。送货客户，可统一选择本组织名称的客户，以便减少调整纠正的工作量。

:::

::: warning 提醒

- 本示例主要原因是因为虚构采购入库，导致后面想出库时报错无法出，就用了一个可以出的事务类型凑和，却完全不知道组别四逐步禁用的定义和要求。所以为彻底解决此问题，规避继续使用导致持续不断的错误，从您看到此段文字后，禁止再使用此组别事务类型记录新业务，仅允许调整历史单据。所有门店调整完毕后，关闭该事务类型。
- 同时，也严格禁止虚构采购入库，禁止要求请参见上述《事务类型分组》章节。
- 调整的单据的仓库及（或）库位，不一定能与原错误的单据的仓库及（或）库位一致，可能因在错误单据的后面发生的业务中，发生了变化，因此请结合实际选择正确的仓库和库位。如果即时库存中的数量、仓库、或库位等不对，可在即时库存中，通过功能组合键【Alt】+【i】，显示按钮【刷新库存】，并通过此按钮刷新库存。

:::

#### 7.2.2 采购价格输入错误，采购价格波动较大

采购时，不小心维护错误的含税单价，是原来的采购价格的10倍或1/10等类似，导致采购入库成本错误，进而也导致出库成本错误。

该问题不显著，如果还有结存数量，通过报表《精品配件平均价》可以得到一些帮助，以梳理出异常的平均单价，进而发现异常的数据。同时，日常出库过程中，库管人员在审核时，应当注意看看出库单上单位实际成本字段，是不是有与实际偏差较大的，如果平常也未发现，可能在关联生成应付单时，才可能发现。

- **示例参考**：示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili02.xlsx)

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili02-01.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili02-01.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **分组数据汇总结果**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili02-02.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili02-02.png',
          
        ]
      }
    }
  }
</script>
```

:::

- **主要错误**：

  因为采购入库不小心错了，进而导致出库成本也错了。

  - 特征六：采购价格错误；
  - 特征九：出库成本明显高于正常出库成本。

  这种录错价格，进而影响出库成本，甚至等到录错价格的单据来发票后，因为核销后导致负结存金额，进而可能导致出库单据无法审核，提示核算中止。

- **调整方法**：（本示例已经调整完毕，所以可以看到调整过程）

  - 调整结存金额：手工新增`出库成本调整单`，调整金额为  -43008.85。把多出的出库成本冲回。即示例中的244、245行。

  - 补增正确入库：先做这步，避免因先做冲销错误入库，导致负结存金额或数量不够，而无法调整的问题。按正常采购业务流程，`补增正确的采购订单、采购入库单`。数量6，实际成本为4778.76。即示例中的246行。

  - 冲销错误入库：对`原错误的采购入库单进行采购退货`，完全退掉。数量-6，实际成本-47787.61，实际成本应当与原错误的保持一致。即示例中的247行。

  - 手工采购核销：对原错误采购入库、新冲销采购退库，进行手工采购核销。核销时，请注意，要核销的金额是不是正好正负相反。

    如果是正好相反，则可以手工采购核销，就不用再生成应付单。

    如果不是正好相反（假设原错误的为47787.60，新冲销的为-47787.61。如果全退，一般不会出现此问题，如果是只退其中一部分，因四舍五入的原因，可能就会出现类似场景），不得直接手工采购核销。参考如下两种方式：

    方式一：当前正在冲销，可对调整的单据直接修改，即在冲销的采购退库单上，把实际成本改成-47787.60；即回到了正好相反。

    方式二：如果已调整完毕，但没注意到四舍五入的原因导致的尾差，则通过应付单核销功能，调整这个差异，即原错误的采购入库推正数应付单，新冲销的采购退库推负数应付单，同时正负应付单的物料、税率保持一致；数量、应付金额、金额、税额，保持正负正好相反。

  - **本示例调整完后，各组别结存数量、结存金额均为0，符合预期**。各调整单据，按正常业务生成凭证。

::: warning 提醒

- 手工采购核销时，如果拟核销的金额，不正好正负相反，则不得手工采购核销，必须通过虚拟一正一负应付单核销，并确保应付单物料、税率、数量、应付金额、金额、税额相对应。
- 实际上，如果做采购发票时发现入库错误，其实可以在关联生成应付单时，直接把含税单价修改正确，确保该笔业务的应付金额、金额、税额与实际发票相符，这样系统会自动产生入库成本调整单。但这里要特别注意的是，不管结存数量是0还是大于0，在我们针对这笔业务的调整完毕后，需确保最终的结存金额=结存数量*真实准确的不含税单价。也即，不要忘记做手工的出库成本调整单，把错误的出库成本，调整到正确的金额，以确保结存金额正确。
- 如果已发现了采购入库错误，采购发票也来了，也做完了，但没有生成入库成本调整单，则说明应付单有严重错误。有可能制单人、审核人，没有仔细审核应付单。要么应付单与实际发票根本对不上，甚至连总数都对不上。要么明细对不上把差额挪到其他物料上了。这两种操作都是非常严重的错误。一方面，该物料的错误没有得到修正，又导致其他物料反而产生了新的错误；一方面可能与供应商的往来也错误了。因此绝对禁止这种胡乱的操作。
- 库管人员在编制采购订单时，应当与原始数据进行核对。如物料明细、数量、含税单价、总的价税合计、总的金额、总的税额。这样就可以在当时就发现问题。而不是事后才发现。
- 调整的单据的仓库及（或）库位，不一定能与原错误的单据的仓库及（或）库位一致，可能因在错误单据的后面发生的业务中，发生了变化，因此请结合实际选择正确的仓库和库位。如果即时库存中的数量、仓库、或库位等不对，可在即时库存中，通过功能组合键【Alt】+【i】，显示按钮【刷新库存】，并通过此按钮刷新库存。

:::

#### 7.2.3 采购退货或价格调整，采购价格波动较大

> 注意，这里和下一小节稍有些区别：
>
> - 本小节冲销的采购退货（与原采购入库是对应的，单位成本一致或近似一致）、补增的采购入库都是正确的。但因为先出库，后调整，导致出库成本多出或少出的场景。这里强调的是**已冲掉**错误的（用负数冲调原错误的正数），再做了正确的（用正数补增）。
> - 下一小节，描述的是采购退货与原采购入库不一致（单位成本不一致），即应该退货的单据因各种原因操作时与原单据不一致。这里强调的是**还没有**冲掉错误的。

在物料出库后，因供应商调整价格、或因集采降价、或发现原来的采购录入错误现在冲销补增后等原因，导致出库成本多出或少出，结存数量为0、结存金额不为0或结存金额不等于数量*实际准确的不含税单价。

如果结存数量为0，结存金额不为0，通过查询《库存类型收发汇总表》，导出报表后，筛选结存数量为0或空，但结存金额不为0且不为空的，即可找到此有问题的物料。

如果结存数量不为0，则应调整的金额可能隐藏在当前的结存金额中，无法直观发现。请结合公式：结存金额  =  结存数量  *  实际准确的不含税单价，判断结存金额是否正确，如果不准确，按照前述<7.1>的描述梳理调整的内容和顺序。

- **示例参考**：示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili03.xlsx)

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili03-01.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili03-01.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **分组数据汇总结果**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili03-02.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili03-02.png',
          
        ]
      }
    }
  }
</script>
```

:::

- **主要错误**：

  采购价格调整或采购入库操作错误，导致出库成本多出或少出；调整正确采购业务后，未及时调整多出或少出的成本。

  - 特征七：冲销的采购退货与新补增的采购入库单价不一致（肯定会不一样，要不然就不需要调整了）；进而导致出库多出或少出成本。
  - 特征十四：结存金额为负；
  - 特例十五：结存数量为0但结存金额不为0。

- **调整方法**：（本示例已经调整完毕，所以可以看到调整过程）

  - 调整结存金额：手工新增`出库成本调整单`，调整金额为  -25.31。把多出的出库成本冲回。即示例中的8行。
- **本示例调整完后，各组别结存数量、结存金额均为0，符合预期**。各调整单据，按正常业务生成凭证。

::: warning 提醒

- 如原价格的采购入库，已与原价格的应付单核销，则采购退货的也应当有原价格的负数应付单（采购发票）。

  新补增的正确采购入库，应该生成正确价格的应付单。

- 如果实际上不是供应商价格调整，而是门店内部操作错误，在冲销错误单据后，一定要记得手工核销。同时库管人员在生成应付单时，应该用新补增的正确的采购入库单生成应付单，而不是用原错误的采购入库单生成应付单。否则可能导致错误的采购入库单下游即有负数入库，又有正数应付，而正确的采购入库没有下游的应付单。导致无法正确核销。切记！！！

- 如原价格的采购入库未核销，供应商未来发票，因现在退货了，供应商也不会再开发票了，则需要自行手工采购核销。则参考如下：

  对原错误采购入库、新冲销采购退库，进行手工采购核销。核销时，请注意，要核销的金额是不是正好正负相反。

  如果是正好相反，则可以手工采购核销，就不用再生成应付单。

  如果不是正好相反（假设原错误的为100，新冲销的为-99.99。如果全退，一般不会出现此问题，如果是只退其中一部分，因四舍五入的原因，可能就会出现类似场景），不得直接手工采购核销。参考如下两种方式：

  方式一：当前正在冲销，可对调整的单据直接修改，即在冲销的采购退库单上，把实际成本修改成一致的（如-100）；即回到了正好相反。

  方式二：如果已调整完毕，但没注意到四舍五入的原因导致的尾差，则通过应付单核销功能，调整这个差异，即原错误的采购入库推正数应付单，新冲销的采购退库推负数应付单，同时正负应付单的物料、税率保持一致；数量、应付金额、金额、税额，保持正负正好相反。

- 调整的单据的仓库及（或）库位，不一定能与原错误的单据的仓库及（或）库位一致，可能因在错误单据的后面发生的业务中，发生了变化，因此请结合实际选择正确的仓库和库位。如果即时库存中的数量、仓库、或库位等不对，可在即时库存中，通过功能组合键【Alt】+【i】，显示按钮【刷新库存】，并通过此按钮刷新库存。

:::

::: danger 特别提醒

- 采购退货时，如果退货的价格比原正向采购的价格低，即折价退还，必须经部门经理、财务、店总审批，甚至经过上级管理小组审批同意后，可方折价退还。否则，不允许折价退还，应当追究责任。

- 如果是内部操作错误的调整，请注意及进手工核销。

- 如果是确实退还给供应商，请注意及时跟进红字采购发票，避免产生损失。

- 较短时间内，同一供应商供应的同一物料，采购价格波动较大，就要高度质疑，是门店把实际不同的物料在系统中录到同一物料？该行为必须禁止，必须按实际分成多个物料进行数据录入。还是供应商价格开错了？一般就低不就高。请与当时采购报价进行对比，确认实际情况，并对错误操作及时进行纠正。

- 如果实际确实为同一物料，且计量单位虽然是同样的，但因为是不确切的，比如一卷（卷有长度的区别）、一面（面有大小的区别）等等，导致采购价格并不固定，如果又不是进一批就出一批，再进再出，而是混在一起，进了这批再进另一批，后面再出，势必导致成本的混乱。因此类似像这样业务：

  方式一：对物料启用批次管理，计价方法改用个别计价法。每次物料进出时，必须输入批次，以确保一一对应。**非实时移动加权平均法的物料在生成凭证前必须进行`材料出库核算`，否则将导致出库成本为0**。门店无法修改已发生过业务的物料的计价方法，如需要修改，联系本部处理。

  方式二：不再使用此物料，新建物料，计量单位选择固化有可比性的同一计量标准的计量单位。

- 在核查某些门店的业务时发现，其退还给供应商的物料，是通过销售业务流程，这个是不对的。应当使用采购退货流程，并对错误的销售业务退回。否则，将导致采购业务挂单、销售业务挂单。除非，确实经过上级管理部门同意，方可以销售流程流转，并向对向开具发票，并保障回款。

  示例：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili03-sale.xlsx)

:::

#### 7.2.4 采购退货与原采购入库价格不一样

> 注意，这里和上一小节稍有些区别：
>
> - 上一小节冲销的采购退货（与原采购入库是对应的，单位成本一致或近似一致）、补增的采购入库都是正确的。但因为先出库，后调整，导致出库成本多出或少出的场景。这里强调的是**已冲掉**错误的（用负数冲调原错误的正数），再做了正确的（用正数补增）。
> - 本小节，描述的是采购退货与原采购入库不一致（单位成本不一致），即应该退货的单据因各种原因操作时与原单据不一致。这里强调的是**还没有**冲掉错误的。

如果现在冲销错误的采购退货，再补增正确的采购退货后，同步还需要判断出库成本是否多出或少出，如有多出或少出则做出库成本调整单调整，如没有则无需做出库成本调整单。

- **示例参考**：示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili04.xlsx)

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili04-01.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili04-01.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **分组数据汇总结果**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili04-02.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili04-02.png',
          
        ]
      }
    }
  }
</script>
```

:::

- **主要错误**：

  采购退货时，因各种原因，导致采购退货的单位成本与原采购入库的单位成本不一致。

  - 特征七：采购退货与原采购入库单价不一致。

- **调整方法**：

  - 冲销错误退库：按正常采购流程做正向采购业务，只不过，采购入库单的物料明细、数量、单位实际成本，与错误的采购退货相对应。

    本示例，采购入库，数量1，单位成本2182.30，实际成本2182.30。

  - 补增正确退库：对刚正向入库进行采购退货，只不过，负数采购退货单的物料明细、数量、单位实际成本，与原始的采购入库相对应。

    本示例，采购退货，数量-1，单位成本2192.92，实际成本-2192.92。

  - 调整出库成本：切不可只做出库成本调整单，而不做如上调整。如果错误的采购退货，影响了出库成本，则需要再通过出库成本调整单调整出库成本。如果没影响，则不需要做。本示例无需做。

::: warning 提醒

- 实际上，如果上述正确的采购入库、错误的采购退货，都还没有来发票，供应商也不会再来发票，则可以虚做正负应付单进行调整。正确的采购入库单关联生成正数应付单，错误的采购退货关联生成负数应付单时，需把应付金额、金额、税额修改和正数应付单的相反金额。而不是反过来，把正数的应付单改成和负数的应付单相对应，切记！！！否则就是错上加错了。如上示例，应该：正数应付单应付金额为2478、金额为2192.92；负数应付单应付金额为-2478、金额为-2192.92。

:::

::: note 上述三项调整的示例区别

- 7.2.2 采购价格错误，还没有调整，应该如何调整。
- 7.2.3 采购退货与采购入库不一致，强调的是正数采购入库不对，采购退货冲销错误的入库，补增正确的入库后，还有异常数据，该如何调整。
- 7.2.4 采购退货与采购入库不一致，强调的是正数采购入库正确，但采购退货错误操作后，应该如何调整。
- 同时强调， 不管入库单据如何错误，基本上是冲销掉错误的单据，补增正确的单据，再在入库单据调整后，核对出库单据是否多出或少出了，据实按需做出库成本调整单调整出库成本，同时特别提醒，因考虑数量不够或金额不够的问题，各调整单据的顺序请结合实际业务。
- 特例：仅有微差的且供应商已开具发票，则可以忽略，直接做出库成本调整单。其他如有采购方面的错误，切不可仅做出库成本调整单，否则要么调整的不完整，要么调整的更加错了。
- 采购数量与单价相反，这样的错误，可以参照这三项调整，结合当前调整在何种进度（完全没有调整、已调整入库方面的错误并冲增正确的单据、仅未调整出库成本），根据数量够不够、金额够不够，确实正数入库、负数入库、出库成本调整这三项的调整顺序。

:::

#### 7.2.5 入库和出库都正确，但因为四舍五入原因导致数量为0结存金额不为0

系统的金额类字段是按两位小数进行四舍五入的，因此这个问题无法完全杜绝，当发现此问题后，参考本示例调整。

- **示例参考**：示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili05.xlsx)

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili05-01.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili05-01.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **分组数据汇总结果**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili05-02.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili05-02.png',
          
        ]
      }
    }
  }
</script>
```

:::

- **主要错误**：

  - 特征十五：结存数量为0，但结存金额不为0。
  - 特征十六：四舍五入的原因。

- **调整方法**：（本示例已经调整完毕，所以可以看到调整过程）

  - 调整结存金额：手工新增`出库成本调整单`，调整金额为  -0.03。把多出的出库成本冲回。即示例中的20行。

  - **本示例调整完后，组别一结存数量为0、结存金额为0，符合预期**。各调整单据，按正常业务生成凭证。

::: warning 提醒

- 结存数量为0，但结存金额不为0的结果，同时会导致库存账龄分析表的汇总数据与财务对应库存商品期末科目余额的汇总数据、三大库存汇总表的期末结存汇总数据，会有差异。

:::

::: tip 提示

- 在实际采购业务中，有种较为特别的操作，采购退货的单位实际成本/实际成本，与正向的采购的单位实际成本/实际成本，有微差，且供应商来的正负发票也是有微差的。从严格意义来说，这样的操作是不对的，但因为其非常微小，我们可有限接受不对，其差异通过出库成本调整单操作。

  但如果供应商没来发票，则不应该通过出库成本调整单操作，应当待供应商来发票再结合实际发票情况。如果供应商既不来正数发票，也不来负数发票。则正数入库虚关联生成正数应付单、负数入库单虚关联生成负数应付单，同时正负应付单的物料、税率保持一致；数量、应付金额、金额、税额，保持正负正好相反，正负应付单合并生成凭证。

  示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili05-pur.xlsx)

  ![](/easpublic/easimg/auto4s-special-104000-shili05-03.png)

:::

#### 7.2.6 计价方法非实时移动加权平均法，生成凭证前又未进行材料出库核算

一般来说，要求物料的计量方法为`实时移动加权平均法`，出库单据审核时即计算出库成本，也可以在生成凭证前通过`材料出库核算`重新核算成本。

**非实时移动加权平均法的物料，在其出库后，生成凭证前，必须做材料出库核算，否则出库单据上的成本为0**。

但当该物料其计量单位并没有固定可比性时，比如一卷（卷有长度的区别）、一面（面有大小的区别）等等，其每批次的价格并不相同时，则该物料的计价方法应该采购`个别计价法`，且此库存资料必须启用批次管理（本部为避免随意勾选，做了限制，如确需要批次管理，需联系本部），在入库业务和出库业务，必须选择准确的批次，否则易导出成本核算错误、收入和发生出现错误。

如果该物料其计量单位是固定的具体可比性，但不小心把物料计价方法错误选择成了非实时移动加权平均法，在联系本部修改计价方法前，则必须在该物料出库后生成凭证前，做材料出库核算，否则将导致出库成本为0，导致数据异常。数据异常时，参与本小节内容调整。同时，尽快联系本部协助修改物料的计价方法。

- **示例参考**：示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili06.xlsx)

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili06-01.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili06-01.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **分组数据汇总结果**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili06-02.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili06-02.png',
          
        ]
      }
    }
  }
</script>
```

:::

- **主要错误**：
  - 特征十五：结存数量为0，但结存金额不为0。
- **调整方法**：（本示例已经调整完毕，所以可以看到调整过程）

  - 调整结存金额：手工新增`出库成本调整单`，调整金额为  1946.90。把少出的出库成本补出。即示例中的6行。
  - 请尽快联系本部协助修改物料的计价方法，或务必请在生成凭证前，进行材料出库核算。
  - **本示例调整完后，组别一结存数量为0、结存金额为0，符合预期**。各调整单据，按正常业务生成凭证。

::: warning 提醒

- 结存数量为0，但结存金额不为0的结果，同时会导致库存账龄分析表的汇总数据与财务对应库存商品期末科目余额的汇总数据、三大库存汇总表的期末结存汇总数据，会有差异。
- 非实时移动加权平均法的物料，请务必在出库后生成凭证前，进行材料出库核算。

:::

#### 7.2.7 出库单据成本核算异常

实际上这种核算异常的问题，很少见。

但往往出现在，先入库错误，出库后，才发现。此时，重新进行正确入库，然后把错误入库删除了。最后又没有做材料出库核算，导致出现最终的问题。

伴随着这样不规范的操作，还会看到示例中的第8行，在该物料不允许负结存的情况下，结存数量居然是负的。就是因为补了正确的单据又再删除了早先的错误单据导致的。

出现这样的问题，主要还是库管人员在操作入库业务时，当时不细心且没有与供应商的清单逐行核对，导致早先的单据错误，事后才发现。

- **示例参考**：示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili07.xlsx)

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili07-01.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili07-01.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **分组数据汇总结果**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili07-02.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili07-02.png',
          
        ]
      }
    }
  }
</script>
```

:::

- **主要错误**：
  - 特征十五：结存数量为0，但结存金额不为0。
- **调整方法**：（本示例已经调整完毕，所以可以看到调整过程）

  - 调整结存金额：手工新增`出库成本调整单`，调整金额为  -227.44。把多出的出库成本冲回。即示例中的9行。

  - **本示例调整完后，组别一结存数量为0、结存金额为0，符合预期**。各调整单据，按正常业务生成凭证。

::: warning 提醒

- 结存数量为0，但结存金额不为0的结果，同时会导致库存账龄分析表的汇总数据与财务对应库存商品期末科目余额的汇总数据、三大库存汇总表的期末结存汇总数据，会有差异。
- 库管人员在操作采购业务时，需要加强对单据的核对，确保录入的数据准确、完整。

:::

#### 7.2.8 销售退库组别与销售出库组别不一致（如组别二出库但组别一退库）

销售退库组别与销售出库组别不一致，易导致错误的结存数量和结存金额。

本示例中，同步涉及虚构采购入库的问题。由于在<7.2.1>中已描述，本示例就不再描述。

- **示例参考**：示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili08.xlsx)

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili08-01.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili08-01.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **分组数据汇总结果**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili08-02.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili08-02.png',
          
        ]
      }
    }
  }
</script>
```

:::

- **主要错误**：
  - 特征四：虚构采购，指定类似0.01的成本；
  - 特征十二：退库组别与出库组别不一致；本示例，出库在组别二、退库在组别一。
- **调整方法**：
  - 冲销错误退库：手工`新增销售出库单`，业务类型：`210 普通销售`，事务类型：`2520 维修出库（索赔）`（因原错误的为索赔），数量为1，单位实际成本计算后应为0.01，实际成本计算后应为0.01。
  - 补增正确退库：手工新增`销售出库单`，业务类型：`211 普通销售退货`，事务类型：`0941 零成本销售退库（库存类型为其它）`（因原出库为`0940`），数量为-1，实际成本为0。
  - 调整的所有单据，生成凭证时，`不过发出商品科目`，借方直接进主营成本/费用/其他业务支出，具体科目，请结合实际业务是维修、还是精品销售、还是配件销售、内部耗用等。
  - **本示例调整完后，组别二结存数量为19、结存金额为0，组别一结存数量为0、结存金额为0，符合预期**。各调整单据，按正常业务生成凭证。

::: warning 提醒

- 在做负向单据时，一定得注意，原正向单据的事务类型，负向单据的事务类型应与之相对应。
- 调整的单据的仓库及（或）库位，不一定能与原错误的单据的仓库及（或）库位一致，可能因在错误单据的后面发生的业务中，发生了变化，因此请结合实际选择正确的仓库和库位。如果即时库存中的数量、仓库、或库位等不对，可在即时库存中，通过功能组合键【Alt】+【i】，显示按钮【刷新库存】，并通过此按钮刷新库存。

:::

#### 7.2.9 初始化有数量无金额日常发生时无法出库用了其他事务类型或影响了日常出库成本

如果库存管理系统上线时，库存初始化时，某物料只有数量没有金额，则在初始化后：

1. 如果第一笔业务是日常出库，则该物料无法出库，会提示核算中止，因为没有结存金额，可能就想方设法使用其他的事务类型。
2. 如果第一笔业务是正常采购，则该物料日常出库，出库成本会被加权核算，导致成本与实际不符。

- **示例参考**：示例文档：[点我下载示例](/easpublic/eastemplate/eashelp-104000-shili09.xlsx)

::: demo

  ```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili09-01.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili09-01.png',
          
        ]
      }
    }
  }
</script>
  ```

:::

- **分组数据汇总结果**：

::: demo

```
<div class="margin: -50px;padding: 0" style="text-align: center;">
  <el-image 
    :src="url" 
    :preview-src-list="srcList">
  </el-image>
</div>
<div style="text-align:center;">【⏫点击图片后滚动鼠标可放大，按住左键不放拖动鼠标可查看更多细节，如有组图可左右切换。如无法点击放大，请刷新本页面】</div>
<script>
  export default {
    data() {
      return {
        url: '/easpublic/easimg/auto4s-special-104000-shili09-02.png',
        srcList: [
          '/easpublic/easimg/auto4s-special-104000-shili09-02.png',
          
        ]
      }
    }
  }
</script>
```

:::

- **主要错误**：

  - 特征一：组别二其它组结存数量为负；
  - 特征九：出库成本异常；
  - 特征十三：普通组结存单位成本与单价单价相差较大。

- **调整方法**：

  本业务在初始化时可能常有（组别一有数量无金额），如果出库时是同组别的，则其成本会滚动到日常的出库中。确保，当前组别一结存金额=实际应结存数量*最新单价。

  如下为不同组别出库时，异常的参考方法：

  方法一：

  - 冲销错误出库：手工新增其他出库单，事务类型：`0952 零成本其他出退库（库存类型为其它）`（因原出库为`0951`），数量为-1，实际成本为0。
  - 冲增正确出库：手工`新增其他出库单`，事务类型：`029 无来源手工出库`，数量为1，单位实际成本计算后应为134.19，实际成本计算后应为134.19。

  - **本示例调整完后，组别二结存数量为0、结存金额为0，组别一结存数量为0、结存金额为0，符合预期**。各调整单据，按正常业务生成凭证。

  方法二：

  - 冲销初始化库存：手工新增其他入库单，事务类型：`0321 无来源手工入退库`，数量为-1，实际成本为0，分录中的赠品字段必须勾选（特别提醒，该字段不得随意勾选，必须按本部指导后才可勾选，未经本部指导不得勾选）。
  - 补增库存：手工新增其他入库单，事务类型：`0921 零成本其他入库-赠送（库存类型为其它）`，数量为1，实际成本为0。
  - 调整出库成本：手工新增出库成本调整单，调整金额为134.19，把少出的成本补出。

::: danger 特别提醒

初始化数量不为0，但金额为0的。在实际业务中可能有如下几种场景：

- 出库时，以组别二、组别三出库，导致错误，方法参考如上。
- 出库时，以组别四出库，导致错误，方法参考如上。
- 出库时，以组别一出库，这个成本已滚动到日常出库中了，如果结存金额没有问题，可不用再调整。如果结存金额有问题，可以出库成本调整单进行调整。
- 如果一直没有组别一普通组的入库，也没有出库。则可以参考上述方法二的前两步，把结存数量从组别一普通组调整到普通二其它组。
- 不管哪种调整方法，必须根据实际，绝对不能不分组，直接就仅以出库成本调整单，调整金额完事，这是绝对错误的。

:::

#### 7.2.10 组别三、组别四结存数量调整到组别二其它组

这个比较好理解，也很容易操作，因此就不截图、举示例了，方法参考如下：

**调整方法**：

- 首先明确组别三、组别四是通过什么单据（单据各类：采购入单正数、其他入库单正数、销售出库单负数、其他出库单负数）增加到系统中的。
- 其次用同样的单据（单据种类：采购入库单负数、其他入库单负数、销售出库单正数、其他出库单正数），**相反的事务类型**冲销组别三、组别四的结存。
- 再者用同样的单据，事务类型名称含`库存类型为其它`的事务类型，补回被冲销调整的数量。

#### 7.2.11 组别二、组别三、组别四业务单据有金额

这个也比较好理解，也比较容易操作，因此就不截图、举示例了，方法参考如下：

**调整方法**：

- 用和原错误的同种单据，相反的事务类型，冲销错误的数量、金额；
- 再用同种单据，同原错误的事务类型，补调正确的数量。
- 这两步，先做增加库存数量的操作、再做减少库存数量的操作，否则可能导致结存数量不够，导致调整无法进行。
- 组别四的单据，如有金额，可能会影响出库成本，请结合实际出库成本，判断是否需要调整出库成本。

#### 7.2.12 异常调拨

任何异常调拨，都是不允许的，常见的异常调拨，查询方法参考如下：

**查询单据**：【库存调拨单】

**常见异常**：

- 异常数据一：业务类型不等于`跨仓库调拨（成本价）`，均为异常。已禁止了非`331 跨仓库调拨（成本价）`的业务类型，所以不会再出现该异常了。

- 异常数据二：单据状态不等于关闭的库存调拨单，均为异常。

  导致单据非关闭状态的原因：

  - 累计调入数量  等于 累计调出数量，但这两者不等于数量。
  - 累计调入数量  不等于 累计调出数量，这点问题严重，等于库存丢失了，有出无入。禁止出现此场景的异常数据。


**调整方法**：

异常数据二，单据状态不等于关闭的库存调拨单，均为异常，其处理方法参考如下：

1. 累计调入数量  等于 累计调出数量，但不等于数量导致未关闭，或虽然等于数量，但仍未关闭：

   - 联系本部对该行数据进行关闭。
   - 日常操作时，要调拨几个，数量就写几个，然后就调拨几个，不要数量随便写，实际调拨的又和这个数量不一致。不调拨的就不要多此一举，不得录入后任其放置，不操作。只要录入的数量，就得按此数量进行调拨。不得小于此数量调拨。
   - 请门店每月结账前，自查，`库存调拨单的单据状态  不等于  关闭`，并及时调拨，确保单据自动关闭。

2. 累计调入数量  不等于  累计调出数量，但未调入的数量通过手工的`其它入库单`补入库了：

   可先通过`库存类型收发明细表`查看收发明细，核查在该调拨出库后，有没有补做的手工其他入库单，如有对应的，则：

   - 对该库存调拨单，关联生成调拨入库单。如果库存调拨单的库存类型为普通，则规则选择`调拨—调拨入库`，必须和调拨出库的相对应；如果库存调拨单的库存类型为其它，则规则选择`调拨—调拨入库（库存类型为其它）`，必须和调拨出库的相对应。不得出现调拨出库为普通、调拨入库为其它；或不得出现调拨出库为其它、调拨入库为普通。
   - 手工其他入库单，事务类型选择与原手工的其他入库单相对应的事务类型，冲销原手工的其他入库单。

3. 累计调入数量  不等于  累计调出数量，且未调入的数量未通过其他任何单据补入到系统中

   可先通过`库存类型收发明细表`查看收发明细，核查在该调拨出库后，有没有补做的手工其他入库单，如没有对应的，则：

   - 对该库存调拨单，关联生成调拨入库单。如果库存调拨单的库存类型为普通，则规则选择`调拨—调拨入库`，必须和调拨出库的相对应；如果库存调拨单的库存类型为其它，则规则选择`调拨—调拨入库（库存类型为其它）`，必须和调拨出库的相对应。不得出现调拨出库为普通、调拨入库为其它；或不得出现调拨出库为其它、调拨入库为普通。
   - 则此数据说明，该数量的物料，实物丢了。建议追查原因，再视追查结果进行指导处理。

#### 7.2.13 其它场景

将根据门店的实际应用，及时补增描述上述未包含的场景。

## 八、难点问题

### 8.1 如何识别采购退货或销售退货，是不是正确？

在实际业务发生过程中，难免发生退货操作。那么如何识别退货的操作是不是正确呢？

有源单的退货（即采购入库退货、销售出库退货）：

- 不管采购退货还是销售退货，退货的负向单据到底是退哪个单据？可以根据《库存类型收发明细表》的订单号来判断，同一订单号的为同一来源，也即退货是退同订单号的正向单据。

- 退货负向单据与原正向单据，其`对应的事务类型应该为同一组别`，如果**不是同一组别，则退货是错误的**，请冲销错误的退货，再重新做正确的退货。

- 退货负向单据的单位成本（即金额/数量），`应当与原正向单据的单位成本一致或近似一致`。如果退货数量与原正向数量一致，则金额也需要一致。

  **如果不一致，则退货是错误的，请冲销错误的退货，再重新做正确的退货**。

- 采购退货，如果与原正向单据的单位成本不一致（如原入库单位成本是100，退货单位成本是90），且这个退货的单位成本，就是供应商要求的单位成本，即折价退还，必须经过部门经理、财务负责人、门店负责人审批同意（线下流程），方可折价退还。如果是大批量的，还必须经过上级管理部门审核同意，方可折价退还。

- 销售退货，不存在折价退还（因为出库单上是成本，是内部的，与客户无关），必须和原正向单据保持一致：即事务类型同组别且对应的（如原正向单据是维修出库（一般维修），则退货应该是维修退库（一般维修））、且单位成本必须一致。如果退货数量与原正向单据一致，则金额也需要一致。

无源单的退货（即其他入库退货、其他出库退货、领料出库对货）：

- 因为无源单，则无法通过系统直接确认哪笔正向单据与本退货是同一笔业务，需要门店自行结合实际业务判断。

### 8.2 组别四逐步禁用组导致的异常数据的参考调整思路

1. 通过《库存类型收发明细表》查询该物料自上线至当日的所有收发明细，注意条件中，请习惯勾选上`显示期初和结存`，并导出至Excel。
2. 筛选`事务类型`列，仅勾选事务类型名称中含`逐步禁用`字样的，得到所有事务类型含`逐步禁用`字样的明细。
3. 选中，收入组数量列，查看数量合计；选中，发出组数量列，查看数量合计。
4. 计算两者的差异，如果差异为0，则该组别的事务类型可不用调整；但，所有逐步禁用的明细中金额列有值的均必须调整。

5. **如果组别四逐步禁用组只有入库（即收入组）有明细，但出库（即发出组）没有明细**，则请：

   场景一：组别四的入库，没有被组别一进行出库，即当前组别一的结存数量大于等于0，且组别四的结存数量等于组别四的收入列数量合计，则：

   - 先冲销错误的其他入库：手工新增其他入库单，事务类型`0928 其他入退库（零成本）（逐步禁用请不要再选择）`，数量为明细表中逐步禁用明细行的收入列数量之和（即3中的收入组数量列合计），实际成本为0；

   - 调整到组别二其它组：手工新增其他入库单，事务类型`0921 零成本其他入库-赠送（库存类型为其它）`，数量为明细表中逐步禁用明细行的收入列数量之和（即3中的收入组数量列合计），实际成本为0；
   - 后续这些原组别四的结存数量出库时，请以组别二其它组的事务类型出库。

   场景二：组别四的入库，有一部分或全部被组别一进行出库，即当前组别一的结存数量小于0，且组别四的结存数量等于组别四的收入列数量合计，则：

   - 确定用了组别一的出库出了多少组别四的数量，记下此数量、实际成本；
   - 冲销组别一的出库：对出库单据进行冲回，原来是销售出库，则用销售出库冲销；原来是其他出库，则用其他出库冲销；事务类型结合实际的出库单据；数量为上述确定的数量，实际成本；
   - 补增组别四的出库：新增销售出库单，事务类型为含`逐步禁用`字样的事务类型，单据类型与原单据类型一致，原来是销售出库，则当前也用销售出库补调；原来是其他出库，则当前也用其他出库补调。
   - 调整成本：同时，因调整出库单，导致组别一的结存金额不等于组别一的结存数量*合理的不含税单价（一般指最新的采购单价，即最后一笔正向采购入库单的金额/数量），则还需要做出库成本调整单，调整多出或少出的出库成本。
   - 调整完后，再分组并查看结存四的数量，如果组别四数量大于0，则再用其他入库单调整到组别二中。参见场景一。

   上述冲销调整的顺序，请先进行增加数量/金额的操作、再进行减少数量/金额的操作。

6. **如果组别四逐步禁用组入库（即收入组）没有明细，但出库（即发出组）有明细**，则请：

   **如果组别四的出库数量合计是正的**A：

   - 冲销错误的销售出库：手工新增销售出库单，业务类型`211 普通销售退货`，事务类型`0948 普通销售退库（零成本）（逐步禁用请不要再选择）`，数量为明细表中逐步禁用明细行的发出列数量之和（即3中的发出组数量列合计），实际成本为0；
   - 调整到组别一普通组：手工新增销售出库单，业务类型`210 普通销售`，请根据上游的单据选择正确的组别一的事务类型（如`2510 维修出库（一般维修）`、`2420 精品销售出库（进精品成本）`等），数量为明细表中逐步禁用明细行的发出列数量之和（即3中的发出组数量列合计），实际成本按系统核算的结果；
   - 结合实际如需要，调整结存金额，确保组别一的结存金额=组别一的结存数量*合理的不含税单价（一般为最新采购入库的单位成本）；
   - 如上三项顺序，参照顺序为：先操作增加数量/金额的单据，再操作减少数量/金额的单据。

   **如果组别四的出库数量合计是负的**B：

   - 调整到组别一普通组：手工新增销售出库单，业务类型`211 普通销售退货`，请根据上游的单据选择正确的组别一的事务类型（如`2511 维修退库（一般维修）`、`2421 精品销售退库（进精品成本）`等），数量为明细表中逐步禁用明细行的发出列数量之和（即3中的发出组数量列合计），实际成本按系统核算的结果；
   - 冲销错误的销售出库：手工新增销售出库单，业务类型`210 普通销售`，事务类型`0947 普通销售出库（零成本）（逐步禁用请不要再选择）`，数量为明细表中逐步禁用明细行的发出列数量之和（即3中的发出组数量列合计），实际成本为0；
   - 结合实际如需要，调整结存金额，确保组别一的结存金额=组别一的结存数量*合理的不含税单价（一般为最新采购入库的单位成本）；
   - 如上三项顺序，参照顺序为：先操作增加数量/金额的单据，再操作减少数量/金额的单据。

7. 如果组别四逐步禁用组，既有入库，也有出库。则计算入库列与出库列的数量差额。

   - 如果组别四的出库数量合计是负的，则出库部分参照上述6中的下半部分B操作，入库部分参照上述5操作。
   - 如果组别四的出库数量合计是正的，且小于入库数量合计，即收入列数量合计多于发出列数量合计，则收入列多余的部分，参照上述5操作。
   - 如果组别四的出库数量合计是正的，且大于入库数量合计，即收入列数量合计少于发出列数量合计，则发出列多余的部分，参照上述6中的上半部分A操作。
   - 如果组别四的出库数量合计，等于入库数量合计，则不用调整。

8. 由于组别四的场景较多，如上述通用的思路无法处理，请反馈给本部予以指导处理。
### 8.3 出库成本调整单何时调整？

在上述各种描述中，常会同步做出库成本调整单，调整出库成本。那哪些场景需要做，又何时调整，其先后顺序是什么？因为场景众多、操作各异，无法穷举所有场景描述是不是需要做，是何时调整。但调整的核心原则都是一样的：

- 先对事务类型分组，确定是不是需要对已发生的业务调整组别；如要调整组别的，请先确定从哪个组别调到哪个组别，数量、金额分别是多少；
- 如果同组别的业务单据，也需要调整的，特别如采购入库的价格错了，确定该冲销多少、补调多少；
- 分组后，并确定如何冲销、如何补调后，此时计算各组别冲销调整后应该结存多少数量、金额；确保：
  - 只有组别一普通组、组别二其它组的结存；
  - 有且只有组别一普通组同时有数量、金额；不能只有数量没有金额，也不能只有金额没有数量；
  - 组别二只有数量；
  - 任何组别的结存，没有负数量、负金额；
- 组别一普通组的结存金额是不是等于合理结存金额（即组别一结存数量 * 合理的不含税单价（一般指最新的采购单价，即最后一笔正向采购入库单的金额/数量）），如果不相等，则计算其两者差异，差异做出库成本调整单。
- 各种冲销单据、补调单据、出库成本调整单的操作顺序，原则：`先做增加数量、金额的操作，再做减少数量、金额的操作`，避免因为数量、金额不够，导致单据无法审核。
- 各种调整单据，请注意其仓库和库位，否则可能导致减少数量的操作可能无法进行，因为可能数量不够。
- 如果通过库存收发明细表，且本次调整的单据也是对的，但在审核时就是提示库存不足，可以对即时库存进行刷新 （即时库存列表，按【Alt】+【i】，输入库存组织、物料，进行刷新），刷新后再审核单据。如果还不行，请仔细检查确认操作是否正确。如果还不行，再联系本部予以协助核查。

## 九、特别说明

本章节，请库管主管、库管员、财务经理、负责精品配件核算的会计及其他相关或愿意学习的人员，认真学习领会，组织内部交流，务必掌握正确的规范、理解核算的逻辑，错误的调整方法。在需要调整时，业务部门和财务部门，积极相互配合，确保数据准确、促进业务顺畅流转。

以上，难免出现错误，如您发现错误，请及时反馈，我们将尽快修正。
